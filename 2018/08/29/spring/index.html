<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Hide it away" />



<meta name="description" content="spring入门">
<meta name="keywords" content="spring框架,开源框架">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring框架入门（1）">
<meta property="og:url" content="http://yoursite.com/2018/08/29/spring/index.html">
<meta property="og:site_name" content="马克图布！">
<meta property="og:description" content="spring入门">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0l4CA6Bb7IbRTrDeDoCT58DGIQ9BH2ibKewbez7JGMrRGqib6OIzibJASlQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0lw2wXzR2NYHa8DE7EPpYH8dib4TTTVDEX6XiaUM9YdjYru4G9wW4daRuQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0lc7FkkhAp34lLAuAEicztAQYyXIL8lfkxYicrdbnENPIWBdxWruwibsITw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/t4kgaKYXPLddlc7umnrUF7XI83xXqY2plsI3ibyPtJM8pRe3emUh66HkZbNdDr2SF8YEqqrFpwatm7icub99iaQbg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/t4kgaKYXPLddlc7umnrUF7XI83xXqY2pvrk0TFI4MrZSs7yUAYiblHsHKjrJeHIzr1krlYOxgg7yjAwgqKiaa0BA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLddlc7umnrUF7XI83xXqY2phnT4S3QeAia1QxDHrK8ymic8tjrJ7gtGtcic7JBDDm4A6xuYKYTXCcPEQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLddlc7umnrUF7XI83xXqY2pwiaSvbXyUfovsiciaYUUibEib2uRTgnynu4bDy0a28lJITKCOAbpicZ8ChiaA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtceyNATlmsicfhiauYqgiaznUupVjiaJolgafjl0Dn1iasBViaAHyb1TubTqA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtM0jnlF2N1icRhYKQt5dibNpW1DH8DdIBictZyl3Jkf0bDDal7lCGia2ckA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtRMcNpKNQaW72qlhO5hib3rxgqu9ervic8PQ6ad8l6hgsGKZm8E6LllVQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtyO9X1JsTEcIcyRIibNy7ib254apm3krJVe8SEUib27jpO0VUY89iaBny1w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtywMP11oSvsficuicg82nxEsxv44jJ9wBbbVVQ60UP0ZnFV25UMiaFlc1Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="c:/Users/ADMINI~1/AppData/Local/Temp/1529581617532.png">
<meta property="og:updated_time" content="2018-08-29T04:44:43.110Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring框架入门（1）">
<meta name="twitter:description" content="spring入门">
<meta name="twitter:image" content="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0l4CA6Bb7IbRTrDeDoCT58DGIQ9BH2ibKewbez7JGMrRGqib6OIzibJASlQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="马克图布！" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/silver/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Spring框架入门（1） | 马克图布！</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: 
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Hide it away</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/archives/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/随笔/">随笔</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:632318927@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="https://weibo.com/u/5317910567/home" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/TheBestLife" title="GitHub"></a>
                            
                                <a class="fa V2EX" href="https://www.v2ex.com/member/TwistedFate" title="V2EX"></a>
                            
                                <a class="fa 知乎" href="/zhihu" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" href="http://music.163.com/#/user/home?id=372823067" title="网易云音乐"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端-js/">-前端 -js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/">DB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitHub/">GitHub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring框架/">spring框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具-Hbuilder/">工具  -Hbuilder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/常用数据库/">常用数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/应用-前端工具/">应用  前端工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源框架/">开源框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/流程/">流程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/版本控制/">版本控制</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">小白猿</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Hide it away</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Hide it away</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/随笔/">随笔</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:632318927@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="https://weibo.com/u/5317910567/home" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/TheBestLife" title="GitHub"></a>
                            
                                <a class="fa V2EX" target="_blank" href="https://www.v2ex.com/member/TwistedFate" title="V2EX"></a>
                            
                                <a class="fa 知乎" target="_blank" href="/zhihu" title="知乎"></a>
                            
                                <a class="fa 网易云音乐" target="_blank" href="http://music.163.com/#/user/home?id=372823067" title="网易云音乐"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-spring" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/08/29/spring/" class="article-date">
      <time datetime="2018-08-29T01:22:59.000Z" itemprop="datePublished">2018-08-29</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Spring框架入门（1）
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/JavaEE/">JavaEE</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring框架/">spring框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开源框架/">开源框架</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Spring框架总结"><a href="#Spring框架总结" class="headerlink" title="Spring框架总结"></a>Spring框架总结</h2><h2 id="1-0-spring简介"><a href="#1-0-spring简介" class="headerlink" title="1.0 spring简介"></a>1.0 spring简介</h2><p> 1.0  Spring 是一个企业级开发框架，为简化企业级项目开发而创建，框架的主要优势之一就是分层架构，允许开发者自主选择组件。</p>
<p> <strong>Spring的两大核心机制就是 IOC  和  AOP</strong></p>
<p>从开发角度上来说，使用Spring就是使用它的IOC和AOP。</p>
<blockquote>
<p> IOC是典型的工厂模式，通过工厂去注入对象。<br>AOP是代理模式的体现。</p>
</blockquote>
<pre><code>  作用 
        主要整合技术框架，
        管理javabean，实现程序中的代码解耦，
        最终提供系统扩展性和维护性

ioc
        控制反转 inversion of control 
   （实例化对象）
          在xml配置文件中表示&lt;bean&gt;元素 class属性
          反射 newInstance()
   di
        依赖注入  dependency injection
        （赋值）
        反射 + 解析xml（jdk）
</code></pre><h2 id="1-1-Spring-IOC"><a href="#1-1-Spring-IOC" class="headerlink" title="1.1 Spring   IOC"></a>1.1 Spring   IOC</h2><h3 id="spring-ioc-介绍"><a href="#spring-ioc-介绍" class="headerlink" title="spring ioc 介绍"></a>spring ioc 介绍</h3><p>​    IOC 控制反转，创建对象交给IOC容器来创建，在推送给调用者。流程反转，所以叫做控制反转。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">原理：</span><br><span class="line">          将所有的javabean对象统一的放入xml中进行管理                 在xml中以bean元素标签体现出来，</span><br><span class="line">          并且形成依赖关系，</span><br><span class="line">            </span><br><span class="line">          容器（tomcat web.xml）,创建所有的对象</span><br><span class="line">          并且形成依赖（赋值）关系，这种依赖关系</span><br><span class="line">          在必要的时候注入使用</span><br><span class="line">          </span><br><span class="line">           最原始的内部new对象，</span><br><span class="line">       转移到外部new对象</span><br><span class="line">          </span><br><span class="line">          内部 new Object（）</span><br><span class="line">          外部 xml bean元素 通过反射实例化对象</span><br><span class="line">          ioc xml + 反射 实例化对象</span><br><span class="line"> </span><br><span class="line">          整合框架（hibernate、mybatis、struts2）</span><br><span class="line"></span><br><span class="line">           管理javabean（实例化对象  new）</span><br></pre></td></tr></table></figure>
<h3 id="注入方法："><a href="#注入方法：" class="headerlink" title="注入方法："></a>注入方法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ioc注入 3种</span><br><span class="line"> 1.setter方法</span><br><span class="line"> 2.构造方法</span><br><span class="line"> 4.普通方法   工厂</span><br></pre></td></tr></table></figure>
<h3 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h3><h4 id="准备工作："><a href="#准备工作：" class="headerlink" title="准备工作："></a>准备工作：</h4><p>​        1.添加Spring相关jar包。</p>
<p>​        2.创建配置文件，可以自定义文件名spring.xml。</p>
<p>​        3.调用API。    </p>
<h4 id="程序思路"><a href="#程序思路" class="headerlink" title="程序思路"></a>程序思路</h4><ol>
<li><p>在spring.xml 中配置bena标签，IOC容器通过bean标签来创建对象。</p>
</li>
<li><p>调用API获取ioc对象。 </p>
<blockquote>
<p>IOC容器可以调用无参构造或者有参构造来创建对象，我们先来看无参构造的方式。 </p>
</blockquote>
</li>
</ol>
<h5 id="gt-无参构造："><a href="#gt-无参构造：" class="headerlink" title="&gt;无参构造：  "></a>&gt;无参构造：  <bean id="sut" class="”com...Student“"><bean></bean></bean></h5><p>​    调用：   &gt;  ApplicationContext applicationContext = new ClassPathXmlApplicationContext(“spring.xml”);               </p>
<p>​                                  Student stu = (Student) applicatioinContext.getBean(“stu”);</p>
<h6 id="gt-无参构造流程"><a href="#gt-无参构造流程" class="headerlink" title="&gt; 无参构造流程"></a>&gt; 无参构造流程</h6><p>​           -  第一步：加载spring.xml配置文件，生成ApplicationContext对象。</p>
<p>​           -   第二步：调用ApplicationContext的getBean方法获取对象，参数为配置文件中的id值。             </p>
<p>​          程序在加载spring.xml时创建stu对象，通过反射机制调用无参构造函数，所有要求交给IOC容器管理的类必须有无参构造函数。                  </p>
<p>######如何赋值：</p>
<p><bean id="stu" class="“" com.etoak.entrity.student”=""><br>​    <property name="id" vlaue="1">  </property><br>​    <property name="name" value="张三"></property><br>​    <property name="age" value="23"></property><br></bean></p>
<p>​         添加property标签：name对应属性名，value是属性的值。 若<strong>包含特殊字符，比如name=”&lt;张三&gt;”，使用&lt;![CDATA[&lt;张三&gt;]]&gt;进行配置。</strong></p>
<blockquote>
<property name="name"><br>​     <value>&lt;![CDATA[&lt;张三&gt;]]&gt;</value><br>  </property> 

</blockquote>
<p>​        Spring通过调用每个属性的setter方法来完成属性的赋值。所以实体类必须有setter方法，否则加载时报错，getter方法可省略。 </p>
<p><strong>2, 通过运行时获取对象</strong></p>
   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student stu = applicationContext.getBean(Student.class);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此方法有一个弊端： 当spring.xml中配置两个Student的bean时，程序报错。容器无法确定返回哪一个。</p>
</blockquote>
<p>以上是IOC容器通过无参构造创建对象的方式，同时IOC容器也可以调用有参构造来创建对象。 </p>
<h5 id="gt-有参构造"><a href="#gt-有参构造" class="headerlink" title="&gt; 有参构造"></a>&gt; 有参构造</h5><p>  首先在实体类中创建有参构造.</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public Student(int id, String name, int age) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.id = id;</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p>xml配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id =&quot;stu3&quot; class=&quot;com..entity.Student&quot;&gt;</span><br><span class="line">    &lt;constructor-arg name=&quot;id&quot; value=&quot;3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;constructor-arg name=&quot;name&quot; value=&quot;xiaoming&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;constructor-arg name=&quot;age&quot; vlaue=&quot;22&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>IOC 容器会根据constructor-arg标签去加载对应的 有参构造函数，创建对象并完成属性赋值。</p>
<p>除了使用name对应参数外，还可以通过下标index对应。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stu3"</span> <span class="attr">class</span>=<span class="string">"com.etoak.Student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"3"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"小明"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"2"</span> <span class="attr">value</span>=<span class="string">"22"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上是IOC容器通过有参构造创建对象的方式，获取对象同样有两种方式可以选择：id和运行时类。 </p>
<blockquote>
<p> 如果IOC容器管理多个对象，并且对象之间有级联关系，如何实现？</p>
</blockquote>
<p>在 Student中有一个Classes类 ，表示所属班级。</p>
<ul>
<li>配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"classes"</span> <span class="attr">class</span>=<span class="string">"com.etoak.entity.Classes"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"Java学习"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stu"</span> <span class="attr">class</span>=<span class="string">"com.etoak.entity.Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[&lt;张三&gt;]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"classes"</span> <span class="attr">ref</span>=<span class="string">"classes"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在spring.xml中，通过ref属性将其他bean赋给当前bean对象，这种方式叫做依赖注入。DI是将不同对象进行关联的一种方式，是IOC具体实现方式。通常DI和IOC紧密结合在一起，所以一般说IOC包括DI。</p>
</blockquote>
<h5 id="gt-集合的依赖注入："><a href="#gt-集合的依赖注入：" class="headerlink" title="&gt; 集合的依赖注入："></a>&gt; 集合的依赖注入：</h5><p> Classes类中添加List<student>属性。 </student></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Classes</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getStudents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> students;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudents</span><span class="params">(List&lt;Student&gt; students)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.students = students;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>spring.xml中配置2个student对象，1个classes对象，并将2个student对象注入到classes对象中 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"classes"</span> <span class="attr">class</span>=<span class="string">"com.etoak.entity.Classes"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">vlaue</span>=<span class="string">"Javak开发"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"students"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"stu"</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"stu2"</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stu"</span> <span class="attr">class</span>=<span class="string">"com.hzit.entity.Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[&lt;张三&gt;]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stu2"</span> <span class="attr">class</span>=<span class="string">"com.hzit.entity.Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"李四"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>集合属性通过list标签和ref标签完成注入。ref的bean属性指向需要注入的bean对象。 </p>
<blockquote>
<p>总结：</p>
</blockquote>
<p>IOC是Spring的核心，很重要。使用Spring开发项目时，控制层，业务层，DAO层都是通过IOC来完成依赖注入的。</p>
<h2 id="1-2-Spring-bean的-Scope"><a href="#1-2-Spring-bean的-Scope" class="headerlink" title="1.2 Spring bean的 Scope"></a>1.2 Spring bean的 Scope</h2><p><strong>1.Spring中的bean是根据scope来生成的，表示bean的作用域。</strong></p>
<h3 id="scope有4种类型："><a href="#scope有4种类型：" class="headerlink" title="scope有4种类型："></a><strong>scope有4种类型：</strong></h3><p>1.singleton：单例，表示通过Spring容器获取的该对象是唯一的。</p>
<p>2.prototype：原型，表示通过Spring容器获取的对象都是不同的。</p>
<p>3.reqeust：请求，表示在一次http请求内有效。</p>
<p>4.session：会话，表示在一个用户会话内有效。</p>
<ul>
<li><p>3和4只适用于web项目，大多数情况下，我们只会使用singleton和prototype两种scope，并且scope的默认值是singleton。 </p>
<p><strong>默认通过Spring容器创建的对象都是单例模式。</strong> </p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.User"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>2.Spring的继承，与Java的继承不一样，但思想很相似，子bean可以继承父bean中的属性。</strong> </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.User"</span> <span class="attr">parent</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 覆盖name属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"李四"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Spring中的bean能不能在不同类之间继承？</p>
<p>答案是可以，但是需要这两个类的属性列表完全一致，否则会报错，实际开发中并不会使用到这种方式。</p>
<h3 id="3-Spring的依赖。"><a href="#3-Spring的依赖。" class="headerlink" title="3.Spring的依赖。"></a><strong>3.Spring的依赖。</strong></h3><p>依赖也是bean和bean之间的一种关联方式，配置依赖关系后，被依赖的bean一定先创建，再创建依赖的bean。 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"car"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.Car"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"brand"</span> <span class="attr">value</span>=<span class="string">"宝马"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3.测试类中获取两个bean </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        User user = (User) applicationContext.getBean(&quot;user&quot;);</span><br><span class="line">        Car car = (Car) applicationContext.getBean(&quot;car&quot;);</span><br></pre></td></tr></table></figure>
<p>  结果，先创建User，后创建Car，这是由spring.xml中bean的配置顺序来决定的，先到先得，先配置User bean，所以先创建了User对象。 </p>
<ul>
<li>现在修改spring.xml配置，User依赖Car，设置depends-on属性。 </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.User"</span> <span class="attr">depends-on</span>=<span class="string">"car"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"23"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"car"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.Car"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"brand"</span> <span class="attr">value</span>=<span class="string">"宝马"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>结果， 先创建Car，后创建User，因为User依赖于Car，所以必须先创建Car对象，User对象才能完成依赖。</p>
<h3 id="4-Spring读取外部资源-–JDBC"><a href="#4-Spring读取外部资源-–JDBC" class="headerlink" title="**4.Spring读取外部资源 –JDBC"></a>**4.Spring读取外部资源 –JDBC</h3><p>​    开发中，数据库的配置会保存在一个properties文件中，便于维护，如果使用Spring容器来生成数据源对象，如何读取到properties配置文件中的内容？</p>
<p>1.创建jdbc.properties。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driverName = com.mysql.jdbc.Driver</span><br><span class="line">url = jdbc:mysql://localhost:3306/myTest?useUnicode=true&amp;characterEncoding=UTF-8</span><br><span class="line">user = root</span><br><span class="line">pwd = 123456</span><br></pre></td></tr></table></figure>
<p>2.spring.xml中配置C3P0数据源。 </p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- 导入外部的资源文件 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:property-placeholder</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- 创建C3P0数据源 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;user&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;pwd&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;driverName&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>第一步：导入外部资源文件。</p>
<p>使用context:property-placeholder标签，需要导入context命名空间。</p>
<p>第二步：通过${}表达式取出外部资源文件的值</p>
<p>3.测试类中获取Spring创建的dataSource对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        DataSource ds = (DataSource) applicationContext.getBean(&quot;dataSource&quot;);</span><br><span class="line">        Connection conn = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            conn = ds.getConnection();</span><br><span class="line">        &#125; catch (SQLException e) &#123;</span><br><span class="line">            // TODO Auto-generated catch block</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-p命名空间的使用"><a href="#5-p命名空间的使用" class="headerlink" title="5.  p命名空间的使用"></a>5.  p命名空间的使用</h3><p>除了使用<property> 元素为Bean 的属性装配值和引用外，Spring 还提供了另外一种bean属性的装配方式：p命名空间，该方式进一步简化配置代码。</property></p>
<ul>
<li>spring.xml中创建User bean和Car bean，并且通过p命名空间给属性赋值，同时完成依赖注入，注意需要引入p命名间。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">     &lt;bean id=&quot;user&quot; class=&quot;com.southwind.entity.User&quot; p:id=&quot;1&quot; p:name=&quot;张三&quot; p:age=&quot;23&quot; p:car-ref=&quot;car&quot;&gt;&lt;/bean&gt;</span><br><span class="line">     &lt;bean id=&quot;car&quot; class=&quot;com.southwind.entity.Car&quot; p:id=&quot;1&quot; p:brand=&quot;宝马&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h2 id="1-3-通过ioc创建对象"><a href="#1-3-通过ioc创建对象" class="headerlink" title="1.3 通过ioc创建对象"></a>1.3 通过ioc创建对象</h2><h4 id="1-IOC通过工厂方法创建对象"><a href="#1-IOC通过工厂方法创建对象" class="headerlink" title="1.IOC通过工厂方法创建对象"></a>1.IOC通过工厂方法创建对象</h4><h5 id="学习静态工厂方法。"><a href="#学习静态工厂方法。" class="headerlink" title="学习静态工厂方法。"></a>学习静态工厂方法。</h5><p>1.创建Car实体类</p>
<p>  2.创建静态工厂类，静态工厂方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class StaticCarFactory &#123;</span><br><span class="line">    private static Map&lt;Integer,Car&gt; cars;</span><br><span class="line">    static&#123;</span><br><span class="line">        cars = new HashMap&lt;Integer,Car&gt;();</span><br><span class="line">        cars.put(1, new Car(1,&quot;奥迪&quot;));</span><br><span class="line">        cars.put(2, new Car(2,&quot;奥拓&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">    public static Car getCar(int num)&#123;</span><br><span class="line">        return cars.get(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.在spring.xml中配置静态工厂。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置静态工厂创建car对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"car1"</span> <span class="attr">class</span>=<span class="string">"com.southwind.entity.StaticCarFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getCar"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="2-实例工厂方法"><a href="#2-实例工厂方法" class="headerlink" title="2.实例工厂方法"></a>2.实例工厂方法</h5><p>1.创建实例工厂类，工厂方法 。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class InstanceCarFactory &#123;</span><br><span class="line">    private Map&lt;Integer,Car&gt; cars;</span><br><span class="line">    public InstanceCarFactory() &#123;</span><br><span class="line">        cars = new HashMap&lt;Integer,Car&gt;();</span><br><span class="line">        cars.put(1, new Car(1,&quot;奥迪&quot;));</span><br><span class="line">        cars.put(2, new Car(2,&quot;奥拓&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">    public Car getCar(int num)&#123;</span><br><span class="line">        return cars.get(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.spring.xml中配置bean。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置实例工厂对象 --&gt;</span><br><span class="line">    &lt;bean id=&quot;carFactory&quot; class=&quot;com.southwind.entity.InstanceCarFactory&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 通过实例工厂对象创建car对象 --&gt;</span><br><span class="line">    &lt;bean id=&quot;car2&quot; factory-bean=&quot;carFactory&quot; factory-method=&quot;getCar&quot;&gt;</span><br><span class="line">        &lt;constructor-arg value=&quot;2&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;/bean&gt; </span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>3.在测试类中直接获取car2对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws SQLException &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        Car car2 = (Car) applicationContext.getBean(&quot;car2&quot;);</span><br><span class="line">        System.out.println(car2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    对比两种方式的区别，静态工厂方法的方式创建car对象，不需要实例化工厂对象，因为静态工厂的静态方法，不需要创建对象即可调用。所以spring.xml只需要配置一个Car bean，而不需要配置工厂bean。</p>
<p>实例工厂方法创建car对象，必须先实例化工厂对象，因为调用的是非静态方法，必须通过对象调用，不能直接通过类来调用，所以spring.xml中需要先配置工厂bean，再配置Car bean。</p>
<p>其实这里考察的就是静态方法和非静态方法的调用。</p>
<h4 id="2-IOC自动装载（autowire）"><a href="#2-IOC自动装载（autowire）" class="headerlink" title="2.IOC自动装载（autowire）"></a>2.IOC自动装载（autowire）</h4><p>​    Spring还提供了另外一种更加简便的方式：自动装载，不需要手动配置property，IOC容器会自动选择bean完成依赖注入。 </p>
<p> 自动装载有两种方式：</p>
<p>byName：通过属性名自动装载</p>
<p>byType：通过属性对应的数据类型自动装载</p>
<p>1,.创建Person实体类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class Person &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Car car;</span><br><span class="line">    public int getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    public Car getCar() &#123;</span><br><span class="line">        return car;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setCar(Car car) &#123;</span><br><span class="line">        this.car = car;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Person [id=&quot; + id + &quot;, name=&quot; + name + &quot;, car=&quot; + car + &quot;]&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.spring.xml中配置Car bean和Person bean，并通过自动装载进行依赖注入。</p>
<p>创建person对象时，没有在property中配置car属性，所以IOC容器会自动进行装载，autowire=”byName”表示通过匹配属性名的方式去装载对应的bean，Person实体类中有car属性，所以就将id=”car”的bean注入到person中。</p>
<p>注意：通过property标签手动进行car的注入优先级更高，若两种方式同时配置，以property的配置为准。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;person&quot; class=&quot;com.southwind.entity.Person&quot; autowire=&quot;byName&quot;&gt; </span><br><span class="line">        &lt;property name=&quot;id&quot; value=&quot;1&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;name&quot; value=&quot;张三&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;car&quot; class=&quot;com.southwind.entity.StaticCarFactory&quot; factory-method=&quot;getCar&quot;&gt;</span><br><span class="line">        &lt;constructor-arg value=&quot;2&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>3.测试类中获取person对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws SQLException &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        Person person = (Person) applicationContext.getBean(&quot;person&quot;);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>同理，byType即通过属性的数据类型来配置。</strong></p>
<p>1.spring.xml配置如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;person&quot; class=&quot;com.southwind.entity.Person&quot; autowire=&quot;byType&quot;&gt; </span><br><span class="line">        &lt;property name=&quot;id&quot; value=&quot;1&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;name&quot; value=&quot;张三&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;car&quot; class=&quot;com.southwind.entity.StaticCarFactory&quot; factory-method=&quot;getCar&quot;&gt;</span><br><span class="line">        &lt;constructor-arg value=&quot;1&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;car2&quot; class=&quot;com.southwind.entity.StaticCarFactory&quot; factory-method=&quot;getCar&quot;&gt;</span><br><span class="line">        &lt;constructor-arg value=&quot;2&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>2.测试类中获取person对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws SQLException &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        Person person = (Person) applicationContext.getBean(&quot;person&quot;);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​        控制台直接打印错误信息，这是因为使用了byType进行自动装载，但是spring.xml中配置了两个Car bean，所以IOC容器不知道应该将哪一个bean装载到person对象中，所以报错。使用byType进行自动装载时，spring.xml中只能配置一个装载的bean。 </p>
<hr>
<h4 id="通过IOC容器架构程序的分层。"><a href="#通过IOC容器架构程序的分层。" class="headerlink" title="通过IOC容器架构程序的分层。"></a>通过IOC容器架构程序的分层。</h4><p>实现有两种方式：基于xml配置文件，基于注解。</p>
<p>思路：</p>
<p>我们把程序分为3层：Controller层，Service层，DAO层。</p>
<p>关系为Controller层调用Service层，Service层调用DAO层，并且Service层和DAO层设计为接口，这是一个典型的MVC模式后台代码分层结构。</p>
<blockquote>
<p>代码：</p>
</blockquote>
<p>基于xml配置方式：</p>
<p>1.创建UserController类。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    public UserService getUserService() &#123;</span><br><span class="line">        return userService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUserService(UserService userService) &#123;</span><br><span class="line">        this.userService = userService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public User getUserById(int id)&#123;</span><br><span class="line">        return userService.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.创建UserService接口以及实现类UserServiceImpl。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface UserService &#123;</span><br><span class="line">    public User getUserById(int id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class UserServiceImpl implements UserService&#123;</span><br><span class="line"></span><br><span class="line">    private UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    public UserDAO getUserDAO() &#123;</span><br><span class="line">        return userDAO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUserDAO(UserDAO userDAO) &#123;</span><br><span class="line">        this.userDAO = userDAO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public User getUserById(int id) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        return userDAO.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.创建UserDAO接口以及实现类UserDAOImpl。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface UserDAO &#123;</span><br><span class="line">    public User getUserById(int id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class UserDAOImpl implements UserDAO&#123;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Integer,User&gt; users;</span><br><span class="line"></span><br><span class="line">    static&#123;</span><br><span class="line">        users = new HashMap&lt;Integer,User&gt;();</span><br><span class="line">        users.put(1, new User(1, &quot;张三&quot;));</span><br><span class="line">        users.put(2, new User(2, &quot;李四&quot;));</span><br><span class="line">        users.put(3, new User(3, &quot;王五&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public User getUserById(int id) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        return users.get(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.创建User实体类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    public int getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    public User(int id, String name) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.id = id;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    public User() &#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User [id=&quot; + id + &quot;, name=&quot; + name + &quot;]&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.在spring.xml配置userController，userService，userDAO，并完成依赖注入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置UserController --&gt;</span><br><span class="line">    &lt;bean id=&quot;userController&quot; class=&quot;com.southwind.controller.UserController&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;userService&quot; ref=&quot;userService&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置UserService --&gt;</span><br><span class="line">    &lt;bean id=&quot;userService&quot; class=&quot;com.southwind.service.impl.UserServiceImpl&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;userDAO&quot; ref=&quot;userDAO&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置UserDAO --&gt;</span><br><span class="line">    &lt;bean id=&quot;userDAO&quot; class=&quot;com.southwind.dao.impl.UserDAOImpl&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>6.在测试类中获取userController对象，调用方法获取user对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        UserController userController = (UserController) applicationContext.getBean(&quot;userController&quot;);</span><br><span class="line">        User user = userController.getUserById(1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="基于注解的方式："><a href="#基于注解的方式：" class="headerlink" title="基于注解的方式："></a>基于注解的方式：</h4><p>第一步：将UserController，UserService，UserDAO类扫描到IOC容器中。</p>
<p>第二步：在类中设置注解完成依赖注入。</p>
<p>1.修改spring.xml。        </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 将类扫描到IOC容器中 --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.southwind&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>base-package=”com.southwind”表示将com.southwind下所有子包的类全部扫描到IOC容器中，一步可将所有参与项目的类完成扫描注入。</p>
<p>注意：需要引入context命名空间。</p>
<p>2.修改UserController，添加注解。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    public User getUserById(int id)&#123;</span><br><span class="line">        return userService.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对比之前的代码，有两处改动：</p>
<p>（1）在类名处添加@Controller注解，表示该类作为一个控制器。</p>
<p>（2）userService属性出添加@Autowired注解，表示IOC容器自动完成装载，默认是byType的方式。</p>
<p>3.修改UserServiceImpl。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class UserServiceImpl implements UserService&#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public User getUserById(int id) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        return userDAO.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同上，做了两处改动：</p>
<p>（1）在类名处添加@Service注解，表示该类是业务层。</p>
<p>（2）userDAO属性出添加@Autowired注解，表示IOC容器自动完成装载，默认是byType的方式。</p>
<p>4.修改UserDAOImpl。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line">public class UserDAOImpl implements UserDAO&#123;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Integer,User&gt; users;</span><br><span class="line"></span><br><span class="line">    static&#123;</span><br><span class="line">        users = new HashMap&lt;Integer,User&gt;();</span><br><span class="line">        users.put(1, new User(1, &quot;张三&quot;));</span><br><span class="line">        users.put(2, new User(2, &quot;李四&quot;));</span><br><span class="line">        users.put(3, new User(3, &quot;王五&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public User getUserById(int id) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        return users.get(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>做了一处改动：在类名处添加@Repository注解，表示该类是数据接口层。</p>
<p>​    </p>
<p>5.运行测试代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span><br><span class="line">        UserController userController = (UserController) applicationContext.getBean(&quot;userController&quot;);</span><br><span class="line">        User user = userController.getUserById(1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>成功，通过代码可以看到，使用注解的方式，可简化代码，所以实际开发中，推荐使用基于注解的方式来架构分层。</p>
<p>我们分别给UserController，UserService，UserDAO添加了@Controller，@Service，@Repository注解。</p>
<p>IOC中可以给类添加的注解有4种：</p>
<p>1.@Controller  </p>
<p>2.@Service</p>
<p>3.@Repository</p>
<p>4.@Component</p>
<p>这四种注解方式没有区别，我们在开发时可以随意使用任意一个注解，但是基于代码规范我们一般选择使用@Controller，@Service，@Repository分别表示Controller层，Service层，DAO层。</p>
<p>前面我们提到过，类中属性自动装载，默认是通过byType的方式。</p>
<p>自动装载除了byType的方式，还可以使用byName的方式，使用byName的方式，需要结合@Qualifier注解一起使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired()</span><br><span class="line">    @Qualifier(&quot;userService&quot;)</span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    public User getUserById(int id)&#123;</span><br><span class="line">        return userService.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们知道byName的方式，是通过属性名去匹配对应bean的id属性值，但是基于注解的方式我们并没有给bean设置id，如何完成呢？</p>
<p>其实我们在类中添加注解时，已经设置了默认的id，即类名首字母小写之后的值就是id的默认值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class UserServiceImpl implements UserService</span><br></pre></td></tr></table></figure>
<p>此时，IOC容器中默认赋值，UserService bean的id=userService，与UserController中的属性名一致，所以可以完成自动。</p>
<p>现在做出修改，手动赋值，设置UserService bean的id=myUserService。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Service(&quot;myUserService&quot;)</span><br><span class="line">public class UserServiceImpl implements UserService&#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public User getUserById(int id) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        return userDAO.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很显然，UserController中的userService属性也需要去匹配name=myUserService的bean，所以设置@Qualifier（”myUserService”）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired()</span><br><span class="line">    @Qualifier(&quot;myUserService&quot;)</span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    public User getUserById(int id)&#123;</span><br><span class="line">        return userService.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Qualifier（）中的值必须与@Service（）中的值一致，才能完成自动装载。</p>
<hr>
<h2 id="代码实例："><a href="#代码实例：" class="headerlink" title="代码实例："></a>代码实例：</h2><h4 id="spring-注入方法"><a href="#spring-注入方法" class="headerlink" title="spring 注入方法"></a>spring 注入方法</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	  1.xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line"><span class="comment">	    new</span></span><br><span class="line"><span class="comment">	  2.xsi:schemaLocation="http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="comment">       	http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span></span><br><span class="line"><span class="comment">       	 类名    对象 Object</span></span><br><span class="line"><span class="comment">      3.xmlns="http://www.springframework.org/schema/beans"</span></span><br><span class="line"><span class="comment">                 别名  变量名称</span></span><br><span class="line"><span class="comment">       </span></span><br><span class="line"><span class="comment">       Object object =  new Object();</span></span><br><span class="line"><span class="comment">       object.属性 方法</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			bean元素表示控制反转  实例化对象</span></span><br><span class="line"><span class="comment">			bean元素下的子元素     依赖注入   赋值</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">        	1.setter注入</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuSetter"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"etoak"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"10"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 2.构造方法 参数名称 注入--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuName"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"易途"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"10"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 2.构造方法 参数下标 注入  参数下标从0开始 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuIndex"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"3"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"et1803"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"2"</span> <span class="attr">value</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 3.普通方法注入  工厂 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuFactoryMethod"</span> </span></span><br><span class="line"><span class="tag">			  <span class="attr">class</span>=<span class="string">"com.etoak.bean.ClassRoom"</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		    <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		    	name属性表示当前bean元素的class属性类中的方法 </span></span><br><span class="line"><span class="comment">		    	bean属性表示引入某个bean元素id属性值</span></span><br><span class="line"><span class="comment">		    --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">lookup-method</span> <span class="attr">name</span>=<span class="string">"getStu"</span> <span class="attr">bean</span>=<span class="string">"stuSetter"</span> /&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Spring-作用域"><a href="#Spring-作用域" class="headerlink" title="Spring 作用域"></a>Spring 作用域</h4><blockquote>
<p>   spring作用域<br>                1.singleton 单例  默认<br>                    始终保持一个对象<br>                    容器启动时就实例化对象<br>                2.prototype 非单例<br>                            每次都会创建一个新的对象<br>                           容器启动时不实例化对象<br>                           当调用getBean方法时，才会实例化对象</p>
</blockquote>
<h4 id="代码实例：-1"><a href="#代码实例：-1" class="headerlink" title="代码实例："></a>代码实例：</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			spring作用域 </span></span><br><span class="line"><span class="comment">			     1.singleton 单例  默认 </span></span><br><span class="line"><span class="comment">			     	始终保持一个对象</span></span><br><span class="line"><span class="comment">			     	容器启动时就实例化对象</span></span><br><span class="line"><span class="comment">			     2.prototype 非单例</span></span><br><span class="line"><span class="comment">			                 每次都会创建一个新的对象</span></span><br><span class="line"><span class="comment">			                容器启动时不实例化对象</span></span><br><span class="line"><span class="comment">			                当调用getBean方法时，才会实例化对象</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">	</span><br><span class="line">	     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuSingleton"</span> </span></span><br><span class="line"><span class="tag">	           <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span> </span></span><br><span class="line"><span class="tag">	           <span class="attr">scope</span>=<span class="string">"singleton"</span> /&gt;</span></span><br><span class="line">	           </span><br><span class="line">	      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuProtoType"</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">scope</span>=<span class="string">"prototype"</span> /&gt;</span>		</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="集合类型，引用类型的-注入"><a href="#集合类型，引用类型的-注入" class="headerlink" title="集合类型，引用类型的 注入"></a>集合类型，引用类型的 注入</h4><p>配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"ob"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.ObjectBean"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- list集合注入 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lists"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>天津<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>重庆<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- set集合注入 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sets"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>et<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>易途<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>et1803<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- map集合注入 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maps"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"etoak"</span> <span class="attr">value</span>=<span class="string">"易途"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"et"</span> <span class="attr">value</span>=<span class="string">"et1803"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- properties集合注入  --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"props"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"et"</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"etoak"</span>&gt;</span>易途<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			注入student对象 </span></span><br><span class="line"><span class="comment">			ref属性表示引入某个bean元素的id属性值</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">			ref</span></span><br><span class="line"><span class="comment">				对象 Object</span></span><br><span class="line"><span class="comment">			value</span></span><br><span class="line"><span class="comment">			   基本数据类型  int</span></span><br><span class="line"><span class="comment">			   包装数据类型  Integer</span></span><br><span class="line"><span class="comment">			   字符串            String</span></span><br><span class="line"><span class="comment">			   日期类型        Date</span></span><br><span class="line"><span class="comment">			     spring默认 不处理日期类型 需要开发人员自定义日期类型  转换</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"stu"</span> <span class="attr">ref</span>=<span class="string">"student"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;property name="stu"&gt;</span></span><br><span class="line"><span class="comment">			&lt;ref bean="student" /&gt;</span></span><br><span class="line"><span class="comment">		&lt;/property&gt; --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;property name="stu"&gt;</span></span><br><span class="line"><span class="comment">			&lt;bean class="com.etoak.bean.Student"&gt;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">				&lt;property name="id" value="1"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">				</span></span><br><span class="line"><span class="comment">				&lt;property name="name"&gt;</span></span><br><span class="line"><span class="comment">					&lt;value&gt;易途&lt;/value&gt;</span></span><br><span class="line"><span class="comment">				&lt;/property&gt;</span></span><br><span class="line"><span class="comment">				</span></span><br><span class="line"><span class="comment">				&lt;property name="age"&gt;</span></span><br><span class="line"><span class="comment">					&lt;value&gt;10&lt;/value&gt;</span></span><br><span class="line"><span class="comment">				&lt;/property&gt;</span></span><br><span class="line"><span class="comment">            &lt;/bean&gt;</span></span><br><span class="line"><span class="comment">		&lt;/property&gt; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>pojo ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectBean</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; lists;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; sets;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,Object&gt; maps;</span><br><span class="line">	<span class="keyword">private</span> Properties props;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Student stu;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getLists</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lists;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLists</span><span class="params">(List&lt;String&gt; lists)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lists = lists;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getSets</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sets;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSets</span><span class="params">(Set&lt;String&gt; sets)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sets = sets;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getMaps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> maps;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMaps</span><span class="params">(Map&lt;String, Object&gt; maps)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.maps = maps;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Properties <span class="title">getProps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> props;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProps</span><span class="params">(Properties props)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.props = props;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Student <span class="title">getStu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> stu;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStu</span><span class="params">(Student stu)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.stu = stu;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>测试：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义spring容器</span></span><br><span class="line">	<span class="keyword">private</span> ApplicationContext ac;</span><br><span class="line">	<span class="comment">//定义ObjectBean对象</span></span><br><span class="line">	<span class="keyword">private</span> ObjectBean ob;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义初始化操作</span></span><br><span class="line">	<span class="meta">@Before</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建spring容器 解析xml配置信息  </span></span><br><span class="line">		<span class="comment">//控制反转（实例化） 依赖注入（赋值）</span></span><br><span class="line">		ac = </span><br><span class="line">		<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取实例化对象</span></span><br><span class="line">		ob = ac.getBean(ObjectBean.class);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//list集合注入</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lists</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;String&gt; list = ob.getLists();</span><br><span class="line">		System.out.println(list);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//set集合注入</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sets</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Set&lt;String&gt; set = ob.getSets();</span><br><span class="line">		System.out.println(set);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//map集合注入</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">maps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Map&lt;String,Object&gt; map = ob.getMaps();</span><br><span class="line">		System.out.println(map);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//properties集合注入</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">props</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Properties p = ob.getProps();</span><br><span class="line">		System.out.println(p);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//注入对象</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Student stu = ob.getStu();</span><br><span class="line">		System.out.println(stu.getId());</span><br><span class="line">		System.out.println(stu.getName());</span><br><span class="line">		System.out.println(stu.getAge());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="配置文件配置-各种方法的设置"><a href="#配置文件配置-各种方法的设置" class="headerlink" title="配置文件配置  各种方法的设置"></a>配置文件配置  各种方法的设置</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		init-method    初始化方法 自定义方法名称时  方法不需要定义参数</span></span><br><span class="line"><span class="comment">		destroy-method 销毁方法 自定义方法名称时  方法不需要定义参数</span></span><br><span class="line"><span class="comment">		                                 容器关闭时 会触发销毁方法</span></span><br><span class="line"><span class="comment">		                                 </span></span><br><span class="line"><span class="comment">		lazy-init      懒加载 默认default false</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		       true懒加载 </span></span><br><span class="line"><span class="comment">		                 当用到（调用）这个方法的时候才会被加载</span></span><br><span class="line"><span class="comment">		                 容器启动时不会实例化对象、也不会注入</span></span><br><span class="line"><span class="comment">		       false 容器启动时，实例化对象、注入</span></span><br><span class="line"><span class="comment">		       </span></span><br><span class="line"><span class="comment">		name和id属性类似     name属性可以设置多个别名</span></span><br><span class="line"><span class="comment">		                                    例如 name="student,stu"</span></span><br><span class="line"><span class="comment">		                                    </span></span><br><span class="line"><span class="comment">		abstract设置当前bean元素为抽象类</span></span><br><span class="line"><span class="comment">		parent继承某个bean元素  通常abstract属性和parent属性组合</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span></span></span><br><span class="line"><span class="tag">		  <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">init-method</span>=<span class="string">"init"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">destroy-method</span>=<span class="string">"destroy"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">lazy-init</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">abstract</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"etoak"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 当前bean继承student --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stu"</span> <span class="attr">parent</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"et1803"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		静态工厂</span></span><br><span class="line"><span class="comment">		类名.静态方法名称();</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		class属性和factory-method属性组合时</span></span><br><span class="line"><span class="comment">		表示的就是静态工厂</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"staticParam"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span></span></span><br><span class="line"><span class="tag">	            <span class="attr">factory-method</span>=<span class="string">"staticParam"</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"str"</span> </span></span><br><span class="line"><span class="tag">					<span class="attr">value</span>=<span class="string">"我是小明，我要去上学！"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 工厂 --&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		实例工厂</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		Object object = new Object();</span></span><br><span class="line"><span class="comment">		object.方法名称();</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		 factory-bean属性和factory-method属性组合时</span></span><br><span class="line"><span class="comment">		  表示是一个实例工厂</span></span><br><span class="line"><span class="comment">		  </span></span><br><span class="line"><span class="comment">		  factory-bean引入某个bean元素id属性值</span></span><br><span class="line"><span class="comment">		  factory-method调用实例对象中的某个方法名称</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	 </span><br><span class="line">	 <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"stuInstance"</span> <span class="attr">class</span>=<span class="string">"com.etoak.bean.Student"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	 <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instanceParam"</span></span></span><br><span class="line"><span class="tag">	       <span class="attr">factory-bean</span>=<span class="string">"stuInstance"</span></span></span><br><span class="line"><span class="tag">	       <span class="attr">factory-method</span>=<span class="string">"instanceParam"</span>&gt;</span></span><br><span class="line">	 </span><br><span class="line">	 	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"str"</span></span></span><br><span class="line"><span class="tag">	 	                <span class="attr">value</span>=<span class="string">"你瞅啥，瞅你咋地！"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>pojo</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"构造方法："</span> + <span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		System.out.println(<span class="string">"setter注入："</span> + name);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"初始化方法！"</span> + getName());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//销毁</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"销毁方法！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义静态方法   类名.静态方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">staticParam</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> str;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义非静态方法</span></span><br><span class="line">	<span class="comment">//Object object = new Object();</span></span><br><span class="line">	<span class="comment">//object.方法名称();</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">instanceParam</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> str;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>调用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//spring容器</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">		<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//父类引用指向子类对象</span></span><br><span class="line">		<span class="comment">//左属性 右方法</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*父类 </span></span><br><span class="line"><span class="comment">		int i = 1;</span></span><br><span class="line"><span class="comment">		public void test1() &#123;</span></span><br><span class="line"><span class="comment">			System.out.println("test1");</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		子类继承父类</span></span><br><span class="line"><span class="comment">		int i = 2;</span></span><br><span class="line"><span class="comment">		public void test1() &#123;</span></span><br><span class="line"><span class="comment">			System.out.println("test2");</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		左属性 右方法</span></span><br><span class="line"><span class="comment">		父类 引用 = new 子类（）；</span></span><br><span class="line"><span class="comment">		引用.i = 1</span></span><br><span class="line"><span class="comment">		引用.test1(); test2*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//默认启动容器</span></span><br><span class="line">		((ClassPathXmlApplicationContext)ac).start();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取实例化对象</span></span><br><span class="line">		Student stu = (Student)ac.getBean(<span class="string">"stu"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//输出信息</span></span><br><span class="line">		System.out.println(stu.getName());</span><br><span class="line">	     System.out.println(<span class="string">"------------------------------"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//工厂</span></span><br><span class="line">		<span class="comment">//调用的是静态方法 staticParam();</span></span><br><span class="line">		String str = (String)ac.getBean(<span class="string">"staticParam"</span>);</span><br><span class="line">		System.out.println(<span class="string">"静态工厂："</span> + str);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//调用的是非静态方法instanceParam();</span></span><br><span class="line">		str = (String)ac.getBean(<span class="string">"instanceParam"</span>);</span><br><span class="line">		System.out.println(<span class="string">"实例工厂："</span> + str);</span><br><span class="line">        <span class="comment">//关闭容器时触发destroy方法 销毁方法</span></span><br><span class="line">		((ClassPathXmlApplicationContext)ac).close();	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Spring-基本注解"><a href="#Spring-基本注解" class="headerlink" title="Spring  基本注解"></a>Spring  基本注解</h4><h5 id="注解总结"><a href="#注解总结" class="headerlink" title="注解总结"></a><strong>注解总结</strong></h5><p>  扫描ioc注解<br>        @Controller @Service @Repository  实例化<br>        @Autowired @Resource 注入</p>
<p>​     component-scan 扫描  当前工程包结构、jar包<br>     <context:component-scan base-package="com.etoak"></context:component-scan></p>
<ul>
<li>@Controller 应用在controller层   处理请求、响应</li>
</ul>
<p>​    实例化对象  默认id属性别名为：类名首字母小写</p>
<bean id="loginController" class="com.etoak.controller.LoginController">

<ul>
<li>@Autowired 注入</li>
</ul>
<ul>
<li>@Service 应用在servie层 处理业务逻辑</li>
</ul>
<p>​     实例化对象 默认id属性别名为：类名首字母小写</p>
<p>​     <bean id="loginServiceImpl" class="com.etoak.service.impl.LoginServiceImpl"></bean></p>
<ul>
<li><p>@Autowired匹配类型  只找类名 不找别名（id）</p>
<pre><code>        @Qualifier(&quot;loginDaoImpl&quot;)
  @Autowired 
**@Autowired 和 @Qualifier组合使用 只找别名**

    **@Resource 注入  jdk**

   **注意事项 ： 在使用@Autowired注解时 当前类必须先实例化 才能注入**
LoginDao dao = new LoginDaoImpl();
LoginDao dao = new LoginDaoImpl2();
@Resource(name=&quot;loginDaoImpl&quot;)
 只找别名，别名没有找到，抛异常
@Resource(type=LoginDao.class)
 只找类型，类型没有找到，抛异常
@Resource(name=&quot;loginDao2&quot; ,type=LoginDao.class)
**错一个都不行** 
</code></pre></li>
<li><p>@Qualifier(“loginDaoImpl”)</p>
<pre><code>@Autowired 
</code></pre></li>
<li><p>@Repository 应用在dao层  sql语句 </p>
<p>​    实例化对象</p>
<p>​    默认id属性别名为：类名首字母小写</p>
<p>​    <bean id="loginDaoImpl" class="com.etoak.dao.impl.LoginDaoImpl"></bean></p>
<p>​    LoginDaoImpl dao = new LoginDaoImpl();</p>
<p>​    LoginDao dao = new LoginDaoImpl();</p>
</li>
</ul>
<hr>
<ul>
<li>xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">   	扫描ioc注解</span></span><br><span class="line"><span class="comment">   	 @Controller @Service @Repository  实例化</span></span><br><span class="line"><span class="comment">   	 @Autowired @Resource 注入</span></span><br><span class="line"><span class="comment">   	 </span></span><br><span class="line"><span class="comment">   	 递推  File</span></span><br><span class="line"><span class="comment">   	 ClassLoader</span></span><br><span class="line"><span class="comment">   	 </span></span><br><span class="line"><span class="comment">   	 component-scan 扫描  当前工程包结构、jar包</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- 	&lt;bean id="dao" class="com.etoak.dao.impl.LoginDaoImpl"&gt;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	&lt;/bean&gt;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	&lt;bean id="service" class="com.etoak.service.impl.LoginServiceImpl"&gt;</span></span><br><span class="line"><span class="comment">		&lt;property name="loginDao" ref="dao"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">	&lt;/bean&gt;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	&lt;bean id="controller" class="com.etoak.controller.LoginController"&gt;</span></span><br><span class="line"><span class="comment">		&lt;property name="loginService" ref="service"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">	&lt;/bean&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span>        <span class="attr">id</span>=<span class="string">"newFixedThreadPool"</span></span></span><br><span class="line"><span class="tag"> 			  <span class="attr">class</span>=<span class="string">"java.util.concurrent.Executors"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">factory-method</span>=<span class="string">"newFixedThreadPool"</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"nThreads"</span> <span class="attr">value</span>=<span class="string">"10"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>pojo</li>
</ul>
<h6 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.service.LoginService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Controller</span> 应用在controller层   处理请求、响应</span></span><br><span class="line"><span class="comment"> *    实例化对象</span></span><br><span class="line"><span class="comment"> *    默认id属性别名为：类名首字母小写</span></span><br><span class="line"><span class="comment"> *    </span></span><br><span class="line"><span class="comment"> *   &lt;bean id="loginController" </span></span><br><span class="line"><span class="comment"> *        class="com.etoak.controller.LoginController" /&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">"loginController"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Resource</span>(name=<span class="string">"newFixedThreadPool"</span>)</span><br><span class="line">	<span class="keyword">private</span> ExecutorService es;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 	<span class="doctag">@Autowired</span> 注入</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> LoginService loginService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username,String password)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">/*	es.submit(new Runnable() &#123;</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">			@Override</span></span><br><span class="line"><span class="comment">			public void run() &#123;</span></span><br><span class="line"><span class="comment">				System.out.println("sadfsadsdf");</span></span><br><span class="line"><span class="comment">				</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;);*/</span></span><br><span class="line">		</span><br><span class="line">		String result = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//controller层调用service层</span></span><br><span class="line">			result = loginService.add(username, password);</span><br><span class="line">		&#125; <span class="keyword">catch</span>(RuntimeException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取service层 抛出的异常信息</span></span><br><span class="line">			result = e.getMessage();</span><br><span class="line">		&#125;</span><br><span class="line">				</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username,String password)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Service</span> 应用在servie层 处理业务逻辑</span></span><br><span class="line"><span class="comment"> *         实例化对象</span></span><br><span class="line"><span class="comment"> *         默认id属性别名为：类名首字母小写</span></span><br><span class="line"><span class="comment"> *  </span></span><br><span class="line"><span class="comment"> * &lt;bean id="loginServiceImpl" </span></span><br><span class="line"><span class="comment"> * 			class="com.etoak.service.impl.LoginServiceImpl" /&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span>(<span class="string">"loginService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServiceImpl</span> <span class="keyword">implements</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * service层调用dao层</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Autowired</span>匹配类型  只找类名 不找别名（id）</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * 	<span class="doctag">@Qualifier</span>("loginDaoImpl")</span></span><br><span class="line"><span class="comment">	 *	<span class="doctag">@Autowired</span> </span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@Autowired</span> 和 <span class="doctag">@Qualifier</span>组合使用 只找别名</span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@Resource</span> 注入  jdk</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 *  注意事项 ： 在使用<span class="doctag">@Autowired</span>注解时 当前类必须先实例化 才能注入</span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  LoginDao dao = new LoginDaoImpl();</span></span><br><span class="line"><span class="comment">	 *  LoginDao dao = new LoginDaoImpl2();</span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@Resource</span>(name="loginDaoImpl")</span></span><br><span class="line"><span class="comment">	 *   只找别名，别名没有找到，抛异常</span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@Resource</span>(type=LoginDao.class)</span></span><br><span class="line"><span class="comment">	 *   只找类型，类型没有找到，抛异常</span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@Resource</span>(name="loginDao2" ,type=LoginDao.class)</span></span><br><span class="line"><span class="comment">	 *  错一个都不行</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="comment">/*@Qualifier("loginDaoImpl")</span></span><br><span class="line"><span class="comment">	@Autowired */</span></span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Resource</span></span><br><span class="line">	<span class="keyword">private</span> LoginDaoImpl loginDao;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(username == <span class="keyword">null</span> || <span class="string">""</span>.equals(username)) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"用户名不能空！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(password == <span class="keyword">null</span> || <span class="string">""</span>.equals(password)) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"密码不能空！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//service层调用dao层</span></span><br><span class="line">		<span class="comment">//dao层将结果返回给service层</span></span><br><span class="line">		String result = loginDao.add(username, password);</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//service层将结果返回给controller层</span></span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h6 id="Dao"><a href="#Dao" class="headerlink" title="Dao"></a>Dao</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginDao</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username,String password)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">    </span><br><span class="line"><span class="keyword">package</span> com.etoak.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.dao.LoginDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Repository</span> 应用在dao层  sql语句 </span></span><br><span class="line"><span class="comment"> * 		实例化对象</span></span><br><span class="line"><span class="comment"> *      默认id属性别名为：类名首字母小写</span></span><br><span class="line"><span class="comment"> *  &lt;bean id="loginDaoImpl" class="com.etoak.dao.impl.LoginDaoImpl" /&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  LoginDaoImpl dao = new LoginDaoImpl();</span></span><br><span class="line"><span class="comment"> *  LoginDao dao = new LoginDaoImpl();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">"loginDao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginDaoImpl</span> <span class="keyword">implements</span> <span class="title">LoginDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"用户名："</span> + username);</span><br><span class="line">		System.out.println(<span class="string">"密码："</span> + password);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> username + <span class="string">"|"</span> + password;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line"> <span class="keyword">package</span> com.etoak.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.dao.LoginDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Repository</span> 应用在dao层  sql语句 </span></span><br><span class="line"><span class="comment"> * 		实例化对象</span></span><br><span class="line"><span class="comment"> *      默认id属性别名为：类名首字母小写</span></span><br><span class="line"><span class="comment"> *  &lt;bean id="loginDaoImpl" class="com.etoak.dao.impl.LoginDaoImpl" /&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  LoginDaoImpl dao = new LoginDaoImpl();</span></span><br><span class="line"><span class="comment"> *  LoginDao dao = new LoginDaoImpl();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">"loginDao2"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginDaoImpl2</span> <span class="keyword">implements</span> <span class="title">LoginDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"用户名2："</span> + username);</span><br><span class="line">		System.out.println(<span class="string">"密码2："</span> + password);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> username + <span class="string">"|"</span> + password;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">		<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		LoginController lc = </span><br><span class="line">				(LoginController)ac.getBean(<span class="string">"loginController"</span>);</span><br><span class="line">		</span><br><span class="line">		String result = lc.add(<span class="string">"etoak"</span>, <span class="string">"et1803"</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(result);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="2-0-Spring-aop-简介"><a href="#2-0-Spring-aop-简介" class="headerlink" title="2.0  Spring   aop 简介"></a>2.0  Spring   aop 简介</h2><h4 id="aop相关"><a href="#aop相关" class="headerlink" title="aop相关"></a>aop相关</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ioc   实例化 赋值</span><br><span class="line">aop 动态代理设计模式  反射   jdk  cglib</span><br><span class="line">   面向切面对象</span><br><span class="line">    全局</span><br><span class="line">   oop  面向对象  局部</span><br><span class="line">        分散</span><br><span class="line">   过滤器 拦截器 权限</span><br><span class="line">     异常</span><br><span class="line">  	 事务</span><br><span class="line">   before   开启事务</span><br><span class="line">   test      insert update delete</span><br><span class="line">   after     提交 或 回滚</span><br><span class="line">          </span><br><span class="line">	before   开启事务</span><br><span class="line">     test</span><br><span class="line">	</span><br><span class="line">     test</span><br><span class="line"> 	after     提交 或 回滚</span><br></pre></td></tr></table></figure>
<h4 id="aop简介"><a href="#aop简介" class="headerlink" title="aop简介"></a>aop简介</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">aop</span><br><span class="line">       分2部分</span><br><span class="line"></span><br><span class="line">       非核心部分  通知</span><br><span class="line">          异常、日志、事务、过滤器 、权限</span><br><span class="line">          缓存 </span><br><span class="line"></span><br><span class="line">           事务 线程 锁 线程池  防止并发</span><br><span class="line">           写 insert update delete</span><br><span class="line">           读 select</span><br><span class="line"></span><br><span class="line">       核心部分 切入点</span><br><span class="line">            增删改查</span><br><span class="line"> </span><br><span class="line">    目标对象</span><br><span class="line">LoginController  交给第三方代理</span><br><span class="line">                        jdk cglib 反射</span><br><span class="line">                        被代理对象</span><br><span class="line">    切入点</span><br><span class="line"></span><br><span class="line">核心部分LoginController类下所有的方法</span><br><span class="line"></span><br><span class="line">       定义连接点方法（切入点）</span><br><span class="line"></span><br><span class="line">    通知/增强</span><br><span class="line">        非核心部分</span><br><span class="line">         通知/增强 4种</span><br><span class="line">         前置通知、后置通知、环绕通知、异常通知</span><br><span class="line"></span><br><span class="line">    连接点</span><br><span class="line">  </span><br><span class="line">	底层连接点</span><br><span class="line">	 	 </span><br><span class="line">通过连接点将通知和切入点</span><br><span class="line">（织入）组装在一起  就一个完整的aop </span><br><span class="line">	 	 </span><br><span class="line">aop = 通知 + 切入点</span><br><span class="line">    before方法</span><br><span class="line">    login方法</span><br><span class="line"></span><br><span class="line">    原理：</span><br><span class="line">         aop分2部分，非核心和核心，</span><br><span class="line">	通过动态代理设计模式（反射）将非核心封装成		aop组件，通过连接点将通知和切入点</span><br><span class="line">       （织入）组装在一起  就一个完整的aop</span><br></pre></td></tr></table></figure>
<p> AOP是Spring框架除了IOC之外的另一个核心概念。</p>
<p>AOP：Aspect Oriented Programming，意为面向切面编程。</p>
<p>这是一个新的概念，我们知道Java是面向对象编程（OOP）：指将所有的一切都看做对象，通过对象与对象之间相互作用来解决问题的一种编程思想。</p>
<p>AOP是对OOP的一个补充，在运行时，动态地将代码切入到类的指定方法、指定位置上的编程思想就是面向切面的编程。将不同方法的同一位置抽象成一个切面对象，对该切面对象进行编程就是AOP。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0l4CA6Bb7IbRTrDeDoCT58DGIQ9BH2ibKewbez7JGMrRGqib6OIzibJASlQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>AOP的优点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.降低模块之间的耦合度。</span><br><span class="line">2.使系统容易扩展。</span><br><span class="line">3.更好的代码复用。</span><br><span class="line">4.非业务代码更加集中，不分散，便于统一管理。</span><br><span class="line">5.业务代码更简洁纯粹，没有其他代码的影响。</span><br></pre></td></tr></table></figure>
<p>说概念太空泛，不好理解，我们还是通过代码来直观感受什么是AOP。</p>
<h4 id="代码示例1："><a href="#代码示例1：" class="headerlink" title="代码示例1："></a>代码示例1：</h4><p>1.创建一个计算器接口 Cal。</p>
<p>定义四个方法：加，减，乘，除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Cal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.创建接口实现类CalImpl。</p>
<p>实现四个方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalImpl</span> <span class="keyword">implements</span> <span class="title">Cal</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1+num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1-num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1*num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1/num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.在测试方法中创建CalImpl对象，调用方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Cal cal = <span class="keyword">new</span> CalImpl();</span><br><span class="line">        cal.add(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.sub(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.mul(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.div(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上这段代码很简单，现添加功能：在每一个方法执行的同时，打印日志信息：该方法的参数列表和该方法的计算结果。</p>
<p>这个需求很简单，我们只需要在每一个方法体中，运算执行之前打印参数列表，运算结束之后打印计算结果即可，对代码做出如下修改。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalImpl</span> <span class="keyword">implements</span> <span class="title">Cal</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(<span class="string">"add方法的参数是["</span>+num1+<span class="string">","</span>+num2+<span class="string">"]"</span>);</span><br><span class="line">        <span class="keyword">int</span> result = num1+num2;</span><br><span class="line">        System.out.println(<span class="string">"add方法的结果是"</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(<span class="string">"sub方法的参数是["</span>+num1+<span class="string">","</span>+num2+<span class="string">"]"</span>);</span><br><span class="line">        <span class="keyword">int</span> result = num1-num2;</span><br><span class="line">        System.out.println(<span class="string">"sub方法的结果是"</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(<span class="string">"mul方法的参数是["</span>+num1+<span class="string">","</span>+num2+<span class="string">"]"</span>);</span><br><span class="line">        <span class="keyword">int</span> result = num1*num2;</span><br><span class="line">        System.out.println(<span class="string">"mul方法的结果是"</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(<span class="string">"div方法的参数是["</span>+num1+<span class="string">","</span>+num2+<span class="string">"]"</span>);</span><br><span class="line">        <span class="keyword">int</span> result = num1/num2;</span><br><span class="line">        System.out.println(<span class="string">"div方法的结果是"</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再次运行代码，成功打印日志信息。</p>
<p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>功能已经实现了，但是我们会发现这种方式业务代码和打印日志代码的耦合性非常高，不利于代码后期的维护。</p>
<p>如果需求改变，需要对打印的日志内容作出修改，那么我们就必须修改4个方法中的所有相关代码，如果是100个方法呢？每次就需要手动去改100个方法中的代码。</p>
<p>换个角度去分析，会发现4个方法中打印日志信息的代码基本相同，那么有没有可能将这部分代码提取出来进行封装，统一维护呢？同时也可以将日志代码和业务代码完全分离开，解耦和。</p>
<p>按照这思路继续向下走，我们希望做的事情是把这4个方法的相同位置（业务方法执行前后）提取出来，形成一个横切面，并且将这个横切面封装成一个对象，将所有的打印日志代码写到这个对象中，以实现与业务代码的分离。</p>
<p>这就是AOP的思想。</p>
<p>如何实现？</p>
<p>使用动态代理的方式来实现。</p>
<p>我们希望CalImpl只进行业务运算，不进行打印日志的工作，那么就需要有一个对象来替代CalImpl进行打印日志的工作，这就是代理对象。</p>
<p>代理对象首先应该具备CalImpl的所有功能，并在此基础上，扩展出打印日志的功能。</p>
<p>1.删除CalImpl方法中所有的打印日志代码，只保留业务代码。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalImpl</span> <span class="keyword">implements</span> <span class="title">Cal</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1+num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1-num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1*num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">int</span> result = num1/num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.创建MyInvocationHandlerl类，并实现InvocationHandler接口，成为一个动态代理类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">    <span class="comment">//被代理对象</span></span><br><span class="line">    <span class="keyword">private</span> Object obj = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回代理对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">bind</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj = obj;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(obj.getClass().getClassLoader(), obj.getClass().getInterfaces(), <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(method.getName()+<span class="string">"的参数是:"</span>+Arrays.toString(args));</span><br><span class="line">        Object result = method.invoke(<span class="keyword">this</span>.obj, args);</span><br><span class="line">        System.out.println(method.getName()+<span class="string">"的结果是:"</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>bind方法是MyInvocationHandlerl类提供给外部调用的方法，传入需要被代理的对象，bind方法会返回一个代理对象。</p>
<p>bind方法完成了两项工作：</p>
<p>1.将外部传进来的被代理对象保存到成员变量中，因为业务方法调用时需要用到被代理对象。</p>
<p>2.通过Proxy.newProxyInstance方法创建一个代理对象。</p>
<p>解释一下Proxy.newProxyInstance方法的参数：</p>
<p>（1）我们知道对象是JVM根据运行时类来创建的，此时需要动态创建一个代理对象，可以使用被代理对象的运行时类来创建代理对象：obj.getClass().getClassLoader（）获取被代理对象的运行时类。</p>
<p>（2）同时代理对象需要具备被代理对象的所有功能，即需要拥有被代理对象的所有接口，所以传入obj.getClass().getInterfaces（）。</p>
<p>（3）this指当前MyInvocationHandler对象。</p>
<p>以上全部是反射（reflect）的知识点。</p>
<p>invoke方法：method是描述被代理对象的所有方法的对象，agrs是描述被代理对象方法的参数列表的对象。</p>
<p>method.invoke(this.obj, args)是通过反射机制来调用被代理对象的方法，即业务方法。</p>
<p>所以在method.invoke(this.obj, args)前后添加打印日志信息，就等同于在被代理对象的业务方法前后添加打印日志信息，并且已经做到了分类，业务方法在被代理对象中，打印日志信息在代理对象中。</p>
<p>测试方法中执行代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//被代理对象</span></span><br><span class="line">        Cal cal = <span class="keyword">new</span> CalImpl();</span><br><span class="line">        MyInvocationHandler mh = <span class="keyword">new</span> MyInvocationHandler();</span><br><span class="line">        <span class="comment">//代理对象</span></span><br><span class="line">        Cal cal2 = (Cal) mh.bind(cal);</span><br><span class="line">        cal2.add(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal2.sub(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal2.mul(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal2.div(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0lw2wXzR2NYHa8DE7EPpYH8dib4TTTVDEX6XiaUM9YdjYru4G9wW4daRuQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>成功，并且现在已经做到了代码分离，CalImpl类中只有业务代码，打印日志的代码写在MyInvocationHandler类中。</p>
<p>以上就是通过动态代理实现AOP的过程，我们在使用Spring框架的AOP时，并不需要这么复杂，Spring已经对这个过程进行了封装，让开发者可以更加便捷的使用AOP进行开发。</p>
<p>接下来我们就来学习Spring框架的AOP如何使用。</p>
<p>在Spring框架中，我们不需要创建动态代理类，只需要创建一个切面类，Spring底层会自动根据切面类以及目标类生成一个代理对象。</p>
<p>1.创建切面类 LoggerAspect</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggerAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"execution(public int com.southwind.aspect.CalImpl.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取方法名</span></span><br><span class="line">        String name = joinPoint.getSignature().getName();</span><br><span class="line">        <span class="comment">//获取参数列表</span></span><br><span class="line">        String args = Arrays.toString(joinPoint.getArgs());</span><br><span class="line">        System.out.println(name+<span class="string">"的参数是:"</span>+args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"execution(public int com.southwind.aspect.CalImpl.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取方法名</span></span><br><span class="line">        String name = joinPoint.getSignature().getName();</span><br><span class="line">        System.out.println(name+<span class="string">"方法结束"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning</span>(value=<span class="string">"execution(public int com.southwind.aspect.CalImpl.*(..))"</span>,returning=<span class="string">"result"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturn</span><span class="params">(JoinPoint joinPoint,Object result)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取方法名</span></span><br><span class="line">        String name = joinPoint.getSignature().getName();</span><br><span class="line">        System.out.println(name+<span class="string">"方法的结果是"</span>+result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing</span>(value=<span class="string">"execution(public int com.southwind.aspect.CalImpl.*(..))"</span>,throwing=<span class="string">"ex"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(JoinPoint joinPoint,Exception ex)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取方法名</span></span><br><span class="line">        String name = joinPoint.getSignature().getName();</span><br><span class="line">        System.out.println(name+<span class="string">"方法抛出异常："</span>+ex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>LoggerAspect类名处添加两个注解：</p>
<p>1.@Aspect：表示该类是切面类。</p>
<p>2.@Component：将该类注入到IOC容器。</p>
<p>分别来说明类中的4个方法注解的含义。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span>(<span class="string">"execution(public int com.southwind.aspect.CalImpl.*(..))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">    <span class="comment">//获取方法名</span></span><br><span class="line">    String name = joinPoint.getSignature().getName();</span><br><span class="line">    <span class="comment">//获取参数列表</span></span><br><span class="line">    String args = Arrays.toString(joinPoint.getArgs());</span><br><span class="line">    System.out.println(name+<span class="string">"的参数是:"</span>+args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.@Before：表示before方法执行的时机。</p>
<p>2.execution(public int com.southwind.aspect.CalImpl.*(..))：表示切入点是</p>
<p>com.southwind.aspect包下CalImpl类中的所有方法。</p>
<p>即CalImpl所有方法在执行之前会首先执行LoggerAspect类中的before方法。</p>
<p>after方法同理，</p>
<p>表示CalImpl所有方法执行之后会执行LoggerAspect类中的after方法。</p>
<p>afterReturn方法表示CalImpl所有方法在return之后会执行LoggerAspect类中的afterReturn方法。</p>
<p>afterThrowing方法表示CalImpl所有方法在抛出异常时会执行LoggerAspect类中的afterThrowing方法。</p>
<p>所以我们就可以根据具体需求，选择在before，after，afterReturn，afterThrowing方法中添加相应代码。</p>
<p>2.目标类也需要添加@Component注解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalImpl</span> <span class="keyword">implements</span> <span class="title">Cal</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> num1+num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> num1-num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> num1*num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">div</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> num1/num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.spring.xml中进行配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.0.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 自动扫描 --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.southwind.aspect&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 使Aspect注解生效，为目标类自动生成代理对象 --&gt;</span><br><span class="line">    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>1.将com.southwind.aspect包中的类扫描到IOC容器中。</p>
<p>2.添加aop:aspectj-autoproxy注解，Spring容器会结合切面类和目标类自动生成动态代理对象，Spring框架的AOP底层就是通过动态代理的方式完成AOP。</p>
<p>4.测试方法执行如下代码：</p>
<p>从IOC容器中获取代理对象，执行方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//加载spring.xml</span></span><br><span class="line">        ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring.xml"</span>);</span><br><span class="line">        <span class="comment">//获取代理对象</span></span><br><span class="line">        Cal cal = (Cal) applicationContext.getBean(<span class="string">"calLogger"</span>);</span><br><span class="line">        <span class="comment">//执行方法</span></span><br><span class="line">        cal.add(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.sub(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.mul(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">        cal.div(<span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLexsDu1uv0NHlYnnW90Fq0lc7FkkhAp34lLAuAEicztAQYyXIL8lfkxYicrdbnENPIWBdxWruwibsITw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>成功。结合代码，回过头来说几个概念更好理解。</p>
<p>切面：横切关注点被模块化的特殊对象。</p>
<p>CalImpl所有方法中需要加入日志的部分，抽象成一个切面对象LoggerAspect。</p>
<p>通知：切面对象完成的工作。</p>
<p>LoggerAspect对象打印日志的操作。</p>
<p>目标：被通知的对象，即被横切的对象。</p>
<p>CalImpl对象。</p>
<p> 代理：切面通知目标混合之后的内容。</p>
<p> 连接点：程序要执行的某个特定位置。</p>
<p>切面方法要插入业务代码的具体位置。</p>
<p> 切点：AOP通过切点定位到连接点。</p>
<h4 id="代码示例2："><a href="#代码示例2：" class="headerlink" title="代码示例2："></a>代码示例2：</h4><ul>
<li>applicationContext.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop/spring-aop-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- advice 通知/增强 --&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 前置通知 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"beforeAdvice"</span> </span></span><br><span class="line"><span class="tag">	        <span class="attr">class</span>=<span class="string">"com.etoak.utils.BeforeAdvice"</span> /&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 后置通知 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"afterAdvice"</span> </span></span><br><span class="line"><span class="tag">			<span class="attr">class</span>=<span class="string">"com.etoak.utils.AfterAdvice"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 环绕通知  适合做缓存--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"aroundAdvice"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">"com.etoak.utils.AroundAdvice"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 异常通知  适合做输出日志信息  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"throwAdvice"</span> </span></span><br><span class="line"><span class="tag">    		<span class="attr">class</span>=<span class="string">"com.etoak.utils.ThrowAdvice"</span> /&gt;</span></span><br><span class="line">	        </span><br><span class="line">	<span class="comment">&lt;!-- aop配置 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			定义切入点 核心部分 代理LoginController对象</span></span><br><span class="line"><span class="comment">			                  LoginController对象交给第三方管理</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">			第一个*表示 方法的返回值 </span></span><br><span class="line"><span class="comment">			第二个*表示 所有的类</span></span><br><span class="line"><span class="comment">			第三个*表示 所有的方法</span></span><br><span class="line"><span class="comment">			com.etoak.controller 表示包结构路径</span></span><br><span class="line"><span class="comment">			(..) 表示参数</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">aop:pointcut</span> </span></span><br><span class="line"><span class="tag">		 		<span class="attr">expression</span>=<span class="string">"execution(* com.etoak.controller.*.*(..))"</span> </span></span><br><span class="line"><span class="tag">		 		<span class="attr">id</span>=<span class="string">"p"</span> /&gt;</span></span><br><span class="line">		 		</span><br><span class="line"></span><br><span class="line">		 </span><br><span class="line">		 <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		 	 底层连接点</span></span><br><span class="line"><span class="comment">		 	 </span></span><br><span class="line"><span class="comment">		 	 通过连接点将通知和切入点组装在一起  就一个完整的aop </span></span><br><span class="line"><span class="comment">		 	 </span></span><br><span class="line"><span class="comment">		 	 aop = 通知 + 切入点</span></span><br><span class="line"><span class="comment">		  --&gt;</span>		</span><br><span class="line">		 <span class="comment">&lt;!-- &lt;aop:advisor advice-ref="beforeAdvice" </span></span><br><span class="line"><span class="comment">		              pointcut-ref="p" /&gt;</span></span><br><span class="line"><span class="comment">		              </span></span><br><span class="line"><span class="comment">		 &lt;aop:advisor advice-ref="afterAdvice" </span></span><br><span class="line"><span class="comment">		              pointcut-ref="p" /&gt; --&gt;</span></span><br><span class="line">		   </span><br><span class="line">		 <span class="comment">&lt;!-- &lt;aop:advisor advice-ref="aroundAdvice" </span></span><br><span class="line"><span class="comment">		              pointcut-ref="p" /&gt; --&gt;</span></span><br><span class="line">		              </span><br><span class="line">		 <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"throwAdvice"</span> </span></span><br><span class="line"><span class="tag">		 			  <span class="attr">pointcut-ref</span>=<span class="string">"p"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 业务类 核心 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"loginController"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">class</span>=<span class="string">"com.etoak.controller.LoginController"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>LoginController.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="comment">//核心部分</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//业务  在spring aop中称为 切入点</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username,String password)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"用户名："</span> + username);</span><br><span class="line">		System.out.println(<span class="string">"密码："</span> + password);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//测试异常通知</span></span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> username + <span class="string">"|"</span> + password;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>BeforeAdvice.java   (前置通知)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">//非核心</span></span><br><span class="line"><span class="comment">//切面类 和 切面</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterAdvice</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通知  后置通知  之后通知</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			Object result, // 目标对象方法返回值</span></span></span><br><span class="line"><span class="function"><span class="params">			Method method, // 目标对象方法</span></span></span><br><span class="line"><span class="function"><span class="params">			Object[] args, // 目标对象方法参数</span></span></span><br><span class="line"><span class="function"><span class="params">			Object object // 目标对象，被代理对象</span></span></span><br><span class="line"><span class="function"><span class="params">			)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"目标对象："</span> </span><br><span class="line">					+ object.getClass().getName());</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"目标对象方法名称："</span> + method.getName());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//目标对象方法返回值</span></span><br><span class="line">		<span class="keyword">if</span>(result != <span class="keyword">null</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"目标对象方法返回值："</span> </span><br><span class="line">						+ result.getClass().getName() </span><br><span class="line">						+ <span class="string">"|"</span> + result);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//目标对象方法参数</span></span><br><span class="line">		<span class="keyword">if</span>(args != <span class="keyword">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span>(Object arg : args) &#123;</span><br><span class="line">				System.out.println(</span><br><span class="line">						arg.getClass().getName() </span><br><span class="line">						+ <span class="string">"|"</span> </span><br><span class="line">						+ arg);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>AfterAdvice.java  (后置通知)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">//非核心</span></span><br><span class="line"><span class="comment">//切面类 和 切面</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterAdvice</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通知  后置通知  之后通知</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			Object result, // 目标对象方法返回值</span></span></span><br><span class="line"><span class="function"><span class="params">			Method method, // 目标对象方法</span></span></span><br><span class="line"><span class="function"><span class="params">			Object[] args, // 目标对象方法参数</span></span></span><br><span class="line"><span class="function"><span class="params">			Object object // 目标对象，被代理对象</span></span></span><br><span class="line"><span class="function"><span class="params">			)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"目标对象："</span> </span><br><span class="line">					+ object.getClass().getName());</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"目标对象方法名称："</span> + method.getName());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//目标对象方法返回值</span></span><br><span class="line">		<span class="keyword">if</span>(result != <span class="keyword">null</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"目标对象方法返回值："</span> </span><br><span class="line">						+ result.getClass().getName() </span><br><span class="line">						+ <span class="string">"|"</span> + result);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//目标对象方法参数</span></span><br><span class="line">		<span class="keyword">if</span>(args != <span class="keyword">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span>(Object arg : args) &#123;</span><br><span class="line">				System.out.println(</span><br><span class="line">						arg.getClass().getName() </span><br><span class="line">						+ <span class="string">"|"</span> </span><br><span class="line">						+ arg);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>AroundAdvice.java    (环绕通知)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aopalliance.intercept.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.aopalliance.intercept.MethodInvocation;</span><br><span class="line">				</span><br><span class="line"><span class="comment">//非核心</span></span><br><span class="line"><span class="comment">//切面类 或 切面</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AroundAdvice</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通知  环绕通知</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation invocation)</span> </span></span><br><span class="line"><span class="function">				<span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*if(true)&#123;</span></span><br><span class="line"><span class="comment">			return "et1801";</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//非核心</span></span><br><span class="line">		before(invocation);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//执行切入点方法    表示开发人员调用的哪个方法就表示是哪个方法</span></span><br><span class="line">		<span class="comment">//login add</span></span><br><span class="line">		<span class="comment">//核心点</span></span><br><span class="line">		Object result = invocation.proceed();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//非核心</span></span><br><span class="line">		after();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//前置通知/增强</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(MethodInvocation invocation)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//目标对象方法参数</span></span><br><span class="line">		Object[] args = invocation.getArguments();</span><br><span class="line">		<span class="comment">//目标对象方法</span></span><br><span class="line">		Method method = invocation.getMethod();</span><br><span class="line">		<span class="comment">//目标对象</span></span><br><span class="line">		Object object = invocation.getThis();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"目标对象:"</span> + object.getClass().getName());</span><br><span class="line">		System.out.println(<span class="string">"目标对象方法:"</span> + method.getName());</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(args != <span class="keyword">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span>(Object arg : args) &#123;</span><br><span class="line">				System.out.println(</span><br><span class="line">						arg.getClass().getName() </span><br><span class="line">						+ <span class="string">"|"</span> </span><br><span class="line">						+ arg);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//后置通知/增强</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"环绕通知：执行后置通知"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>异常通知</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.ThrowsAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">//非核心部分</span></span><br><span class="line"><span class="comment">//切面类 或 切面</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThrowAdvice</span></span></span><br><span class="line"><span class="class">			 <span class="keyword">implements</span> <span class="title">ThrowsAdvice</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//异常通知  等价后置通知</span></span><br><span class="line">	<span class="comment">//当切入点方法出现异常时 触发afterThrowing方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Method method, Object[] args, Object target,Exception ex)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"异常信息："</span> + ex.getMessage());</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//格式化时间 每天按时间来生成文件 ， 每天一个异常信息文件</span></span><br><span class="line">		SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">		String date = sdf.format(<span class="keyword">new</span> Date());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将异常信息保存文件中，方便开发人员定位异常信息</span></span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">				FileOutputStream out =</span><br><span class="line">						<span class="keyword">new</span> FileOutputStream(<span class="string">"C:/"</span> + date + <span class="string">".txt"</span>,<span class="keyword">true</span>);</span><br><span class="line">				</span><br><span class="line">				PrintWriter pw = <span class="keyword">new</span> PrintWriter(out);</span><br><span class="line">		    ) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//将异常信息传输给PrintWriter包装流，</span></span><br><span class="line">			<span class="comment">//PrintWriter包装流再传输给FileOutputStream流</span></span><br><span class="line">			<span class="comment">//最后生成文件  格式：yyyy-MM-dd.txt</span></span><br><span class="line">			pw.write(target.getClass().getName() + <span class="string">"\t\n"</span>);</span><br><span class="line">			pw.write(method.getName() + <span class="string">"\t\n"</span>);</span><br><span class="line">			ex.printStackTrace(pw);</span><br><span class="line">			pw.write(<span class="string">"\t\n"</span>);</span><br><span class="line">			pw.write(<span class="string">"=================="</span> + <span class="string">"\t\n"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">		    e.printStackTrace();	</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Test</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.controller.LoginController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//spring容器</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">		<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取实例化对象</span></span><br><span class="line">		LoginController lc =</span><br><span class="line">				(LoginController)ac.getBean(<span class="string">"loginController"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//代理之后的切入点方法 会执行通知/增强操作</span></span><br><span class="line">		String result = lc.login(<span class="string">"etoak"</span>, <span class="string">"et1803"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//输出结果</span></span><br><span class="line">		System.out.println(<span class="string">"返回结果："</span> + result);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-0-Spring整合mybatis"><a href="#3-0-Spring整合mybatis" class="headerlink" title="3.0 Spring整合mybatis"></a>3.0 Spring整合mybatis</h2><h4 id="操作数据库相关知识"><a href="#操作数据库相关知识" class="headerlink" title="操作数据库相关知识"></a>操作数据库相关知识</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">plsql  </span><br><span class="line">		</span><br><span class="line">               1.解析主配置文件</span><br><span class="line">                  settings属性</span><br><span class="line">		  数据源 连接数据库</span><br><span class="line">                  实体类起别名</span><br><span class="line">                  映射sql.xml配置</span><br><span class="line">                  插件</span><br><span class="line"></span><br><span class="line">               2.SqlSessionFactory对象</span><br><span class="line"></span><br><span class="line">               3.通过SqlSessionFactory对象获取SqlSession</span><br><span class="line"></span><br><span class="line">               4.SqlSession开启事务</span><br><span class="line"></span><br><span class="line">               5.持久化操作SqlSession</span><br><span class="line">                  ibatis</span><br><span class="line">                  	selectOne(&quot;id&quot;,&quot;param&quot;)</span><br><span class="line">                  	selectList（“id”，“param”）</span><br><span class="line">                  mybatis</span><br><span class="line">                      接口 别名(接口)getMapper(接口.class)</span><br><span class="line">                           别名.接口方法名称（）；</span><br><span class="line">               6.SqlSession提交或回滚</span><br><span class="line"></span><br><span class="line">               7.关闭SqlSession</span><br><span class="line">                  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">               mybatis  </span><br><span class="line">                      半自动</span><br><span class="line">                     手写sql语句  方便优化sql语句</span><br><span class="line">                     返回结果集 resultType resultMap</span><br><span class="line">                     通过反射封装面向对象</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">              spring</span><br><span class="line">                   非注解形式</span><br><span class="line">                     &lt;bean&gt;元素</span><br><span class="line">                   注解形式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		非注解</span><br><span class="line">                    spring框架提供的类  &lt;bean&gt;元素</span><br><span class="line">                     </span><br><span class="line">	 	注解</span><br><span class="line">                    业务逻辑 增删查改</span><br><span class="line">                    开发人员自定义的类可以使用注解实例化</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">               mybatis</span><br><span class="line">                  动态标签</span><br><span class="line">                   if where foreach sql</span><br><span class="line"> </span><br><span class="line">               #(?) </span><br><span class="line">               $(字符串 原样输出) like</span><br><span class="line"></span><br><span class="line">                select * from 表名 </span><br><span class="line">		where username = ‘etoak’</span><br><span class="line">		 and password =    “or 1=1”</span><br><span class="line"></span><br><span class="line">             jdbc vs  mybatis  vs hibernate </span><br><span class="line"></span><br><span class="line">               get vs post</span><br><span class="line">               请求转发 vs 重定向</span><br><span class="line">               九大内置对象 **********************</span><br><span class="line">               session vs cookie  单点登录 sso</span><br><span class="line">               jquery</span><br><span class="line">             </span><br><span class="line">               创建表的3范式</span><br><span class="line">               1.关系型数据库  oracle mysql</span><br><span class="line">               2.在表中的一条记录中有个多字段，</span><br><span class="line">                 多个字段中必须有一个字段是唯一的</span><br><span class="line">                 主键</span><br><span class="line">                 例如  id 主键</span><br><span class="line">               3.字段不能冗余</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line">               反3范式（第三范式）</span><br><span class="line">                  字段可以冗余</span><br><span class="line">          </span><br><span class="line">                单表</span><br><span class="line">                一对一  主 从（主外键）</span><br><span class="line">                一对多  主 从（主外键）</span><br><span class="line">                多对多  桥表（外键）</span><br><span class="line">            </span><br><span class="line">             user</span><br><span class="line"> 		id   name  deptId deptName</span><br><span class="line"></span><br><span class="line">             dept</span><br><span class="line">                id   name</span><br><span class="line">   </span><br><span class="line">          select b.name from </span><br><span class="line">		user a</span><br><span class="line">                	left join </span><br><span class="line">                dept b</span><br><span class="line">                       on  a.deptId = b.id</span><br><span class="line"></span><br><span class="line">          select deptName from user</span><br></pre></td></tr></table></figure>
<h2 id="4-0-Spring-mvc-总结"><a href="#4-0-Spring-mvc-总结" class="headerlink" title="4.0  Spring mvc 总结"></a>4.0  Spring mvc 总结</h2><h4 id="SpringMvc简介"><a href="#SpringMvc简介" class="headerlink" title="SpringMvc简介"></a>SpringMvc简介</h4><p>SpringMVC是什么？</p>
<p>SpringMVC是目前最好的实现MVC设计模式的框架，是Spring框架的一个分支产品，以SpringIOC容器为基础，并利用容器的特性来简化它的配置。SpringMVC相当于Spring的一个子模块，可以很好的和Spring结合起来进行开发，是JavaWeb开发者必须要掌握的框架。</p>
<p>SpringMVC能干什么？</p>
<p>实现了MVC设计模式，MVC设计模式是一种常用的软件架构方式：以Controller（控制层），Model（模型层），View（视图层）三个模块分离的形式来组织代码。</p>
<p>MVC流程：控制层接受到客户端请求，调用模型层生成业务数据，传递给视图层，将最终的业务数据和视图响应给客户端做展示。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/t4kgaKYXPLddlc7umnrUF7XI83xXqY2plsI3ibyPtJM8pRe3emUh66HkZbNdDr2SF8YEqqrFpwatm7icub99iaQbg/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>SpringMVC就是对这套流程的封装，屏蔽掉很多底层代码，开放出接口，让开发者可以更加轻松快捷的完成基于MVC模式的Web开发。</p>
<h4 id="SpringMVC实现原理："><a href="#SpringMVC实现原理：" class="headerlink" title="SpringMVC实现原理："></a>SpringMVC实现原理：</h4><p>核心组件：</p>
<p>1.DispatcherServlet：前端控制器，是整个流程控制的核心，控制其他组件的执行，统一调度，降低组件之间的耦合性，相当于总指挥。</p>
<p>2.Handler：处理器，完成具体业务逻辑，相当于Servlet或Action。</p>
<p>3.HandlerMapping：DispatcherServlet接收到请求之后，通过HandlerMapping将不同的请求分发到不同的Handler。</p>
<p>4.HandlerInterceptor：处理器拦截器，是一个接口，如果我们需要做一些拦截处理，可以来实现这个接口。</p>
<p>5.HandlerExecutionChain：处理器执行链，包括两部分内容：Handler和HandlerInterceptor（系统会有一个默认的HandlerInterceptor，如果需要额外拦截处理，可以添加拦截器设置）。</p>
<p>6.HandlerAdapter：处理器适配器，Handler执行业务方法之前，需要进行一系列的操作包括表单数据的验证，数据类型的转换，将表单数据封装到JavaBean等等，这一系列的操作，都是由HandlerAdapter来完成，DispatcherServlet通过HandlerAdapter执行不同的Handler。</p>
<p>7.ModelAndView：装载了模型数据和视图信息，作为Handler的处理结果，返回给DispatcherServlet。</p>
<p>8.ViewResolver：视图解析器，DispatcherServlet通过它将逻辑视图解析成物理视图，最终将渲染结果响应给客户端。</p>
<p>以上就是SpringMVC的核心组件。那么这些组件之间是如何进行交互的呢？</p>
<p>我们来看SpringMVC的实现流程：</p>
<p>1.客户端请求被DispatcherServlet（前端控制器）接收。</p>
<p>2.根据HandlerMapping映射到Handler。</p>
<p>3.生成Handler和HandlerInterceptor（如果有则生成）。</p>
<p>4.Handler和HandlerInterceptor以HandlerExecutionChain的形式一并返回给DispatcherServlet。</p>
<p>5.DispatcherServlet通过HandlerAdapter调用Handler的方法做业务逻辑处理。</p>
<p>6.返回一个ModelAndView对象给DispatcherServlet。</p>
<p>7.DispatcherServlet将获取的ModelAndView对象传给ViewResolver视图解析器，将逻辑视图解析成物理视图View。</p>
<p>8.ViewResolver返回一个View给DispatcherServlet。</p>
<p>9.DispatcherServlet根据View进行视图渲染（将模型数据填充到视图中）。</p>
<p>10.DispatcherServlet将渲染后的视图响应给客户端。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/t4kgaKYXPLddlc7umnrUF7XI83xXqY2pvrk0TFI4MrZSs7yUAYiblHsHKjrJeHIzr1krlYOxgg7yjAwgqKiaa0BA/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">springmvc集成 spring、servlet、restful</span><br><span class="line">                           </span><br><span class="line">                      restful</span><br><span class="line">                            网络传输，高并发、高延迟</span><br><span class="line">                      </span><br><span class="line">                      get      select</span><br><span class="line">                      post     insert</span><br><span class="line">                      put      update</span><br><span class="line">                      delete   delete</span><br><span class="line"></span><br><span class="line">http://www.tuicool.com/articles/67vyIbv  			jersey</span><br><span class="line"></span><br><span class="line">            springmvc集成spring</span><br><span class="line">              spring是父容器  </span><br><span class="line">              springmvc是子容器</span><br><span class="line"></span><br><span class="line">         </span><br><span class="line">         jdk          tomcat      web.xml</span><br><span class="line">         1.6 1.7       6.X         2.5</span><br><span class="line">         1.7.1.8       7.X         3.0</span><br><span class="line">         1.8           8.X         3.1   nio</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">            new io</span><br><span class="line">  web.xml</span><br><span class="line">  mybatis-----------</span><br><span class="line">   jsp  </span><br><span class="line">   web.xml</span><br><span class="line">   controller</span><br><span class="line">   service</span><br><span class="line">   dao mapper</span><br></pre></td></tr></table></figure>
<p>常见错误 ：400   参数不匹配</p>
<p>spring默认不处理日期类型</p>
<h5 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h5><p>如何使用？</p>
<p>看到上面的实现原理，大家可能会有这样的担心，SpringMVC如此众多的组件开发起来一定很麻烦吧？答案是否定的，SpringMVC使用起来非常简单，很多组件都由框架提供，作为开发者我们直接使用即可，并不需要自己手动编写代码，真正需要我们开发者进行编写的组件只有两个，Handler：处理业务逻辑， View：JSP做展示。</p>
<h6 id="代码示例-1："><a href="#代码示例-1：" class="headerlink" title="代码示例 1："></a>代码示例 1：</h6><p>1.环境搭建    </p>
<p>创建maven工程，创建pom.xml配置SpringMVC依赖jar包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</span><br><span class="line">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">  &lt;groupId&gt;com.hzit&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;SpringMVCMaven&lt;/artifactId&gt;</span><br><span class="line">  &lt;packaging&gt;war&lt;/packaging&gt;</span><br><span class="line">  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">  &lt;name&gt;SpringMVCTest Maven Webapp&lt;/name&gt;</span><br><span class="line">  &lt;url&gt;http://maven.apache.org&lt;/url&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;4.8.1&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;4.3.1.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">   &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">  &lt;build&gt;</span><br><span class="line">    &lt;finalName&gt;SpringMVCTest&lt;/finalName&gt;</span><br><span class="line">  &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p>2.web.xml中配置SpringMVC的DispatcherServlet。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app version=&quot;2.5&quot; </span><br><span class="line">    xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; </span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; </span><br><span class="line">    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee </span><br><span class="line">    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;&gt;</span><br><span class="line">  &lt;display-name&gt;&lt;/display-name&gt;    </span><br><span class="line">      &lt;welcome-file-list&gt;</span><br><span class="line">           &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;</span><br><span class="line">      &lt;/welcome-file-list&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">              &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">              &lt;!-- 指定springmvc.xml的路径 --&gt;</span><br><span class="line">              &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;</span><br><span class="line">        &lt;/init-param&gt;</span><br><span class="line">      &lt;/servlet&gt;</span><br><span class="line">      &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">      &lt;/servlet-mapping&gt; </span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<p>3.创建springmvc.xml配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置自动扫描 --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.southwind.handler&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置视图解析器 --&gt;</span><br><span class="line">    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</span><br><span class="line">        &lt;!-- 前缀 --&gt;</span><br><span class="line">        &lt;property name=&quot;prefix&quot; value=&quot;/&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;!-- 后缀 --&gt;</span><br><span class="line">        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>自动扫描的类结合注解交给IOC容器来管理，视图解析器是SpringMVC底层的类，开发者只需要进行配置即可完成JSP页面的跳转，如何配置很简单，记住一条：目标资源路径=前缀+返回值+后缀。</p>
<p>比如DispatcherServlet返回index，配置文件中前缀是/，后缀是.jsp，代入上述公式：</p>
<p>目标资源路径=/index.jsp。一目了然，不需要再解释。</p>
<p>4.创建Handler类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class HelloHandler &#123;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/index&quot;)</span><br><span class="line">    public String index()&#123;</span><br><span class="line">        System.out.println(&quot;执行index业务代码&quot;);</span><br><span class="line">        return &quot;index&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>直接在业务方法出添加注解@RequestMapping(“/index”)，将URL请求index直接与index业务方法映射，使用起来非常方便。</p>
<p>5.启动tomcat，打开浏览器输入URL测试。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLddlc7umnrUF7XI83xXqY2phnT4S3QeAia1QxDHrK8ymic8tjrJ7gtGtcic7JBDDm4A6xuYKYTXCcPEQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLddlc7umnrUF7XI83xXqY2pwiaSvbXyUfovsiciaYUUibEib2uRTgnynu4bDy0a28lJITKCOAbpicZ8ChiaA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>1.DispatcherServlet接收到URL请求index，结合@RequestMapping(“/index”)注解将该请求交给index业务方法。</p>
<p>2.执行index业务方法，控制打印日志，并返回”index”字符串。</p>
<p>3.结合springmvc.xml中的视图解析器配置，找到目标资源：/index.jsp，即根目录的index.jsp，将该jsp资源返回客户端完成响应。</p>
<p>SpringMVC环境搭建成功。</p>
<h6 id="代码示例2：-1"><a href="#代码示例2：-1" class="headerlink" title="代码示例2："></a>代码示例2：</h6><ul>
<li>etoak-servlet.xml  （springmvc配置文件）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		扫描ioc注解</span></span><br><span class="line"><span class="comment">			@Controller</span></span><br><span class="line"><span class="comment">		      spring 实例化</span></span><br><span class="line"><span class="comment">              springmvc 实例化 服务端</span></span><br><span class="line"><span class="comment">		    @Service @Repository @Autowired等</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		当前扫描操作不是spring ，是springmvc</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		多个bean元素  </span></span><br><span class="line"><span class="comment">		映射器(请求)、适配器（执行方法）、类型转换 （参数、json）</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		视图解析器 </span></span><br><span class="line"><span class="comment">		/success.jsp</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>web.xml    (web.xml中配置SpringMVC的DispatcherServlet。)</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>springmvc01<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 请求 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 响应 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 end --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- springmvc start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		默认加载springmvc配置文件路径为：</span></span><br><span class="line"><span class="comment">  				WEB-INF/[servlet-name]-serlvet.xml</span></span><br><span class="line"><span class="comment">  	 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springmvc end --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>前端页面</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">login.jsp----------------------------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		$&#123;pageContext.request.contextPath &#125;</span></span><br><span class="line"><span class="comment">		el表达式 获取工程名</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		get请求 尽量别传中文参数  会乱码</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		/springmvc01/login.do?username=value&amp;password=value</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/login.do"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">	      </span><br><span class="line">	      用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	      密码：  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span>  </span><br><span class="line">	      <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	      </span><br><span class="line">	        <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	        		注意事项：使用js事件</span></span><br><span class="line"><span class="comment">	        		 例如点击事件 按钮类型不要使用submit类型 </span></span><br><span class="line"><span class="comment">	        --&gt;</span></span><br><span class="line">	        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span> /&gt;</span> </span><br><span class="line">	   </span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">register.jsp--------------------------------------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/login.do"</span></span></span><br><span class="line"><span class="tag">	      <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">	      </span><br><span class="line">	      用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	      </span><br><span class="line">	      密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	      </span><br><span class="line">	      生日：<span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"birthDay"</span>&gt;</span></span><br><span class="line">	        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"1990-01-01"</span>&gt;</span>1990-01-01<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">	        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"1991-02-02"</span>&gt;</span>1991-02-02<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">	        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"1992-03-03"</span>&gt;</span>1992-03-03<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">	       <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	      </span><br><span class="line">	       性别：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"1"</span> /&gt;</span>男</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"2"</span> /&gt;</span>女</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span>人妖</span><br><span class="line">	       <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	       </span><br><span class="line">	       爱好：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"1"</span> /&gt;</span>抽烟</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"2"</span> /&gt;</span>喝酒</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span>烫头</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"4"</span> /&gt;</span>纹身</span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span>撩妹</span><br><span class="line">	       <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	       </span><br><span class="line">	       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"注册"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line">success.jsp-------------------------</span><br><span class="line">    <span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">成功！！！！！</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">$&#123;msg &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>controller层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * springmvc集成spring</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Controller</span> </span></span><br><span class="line"><span class="comment"> *    spring 实例化</span></span><br><span class="line"><span class="comment"> *    springmvc 实例化 服务端 接收请求</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@RequestMapping</span></span></span><br><span class="line"><span class="comment">	 *       接收请求  例如/login请求</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@RequestParam</span></span></span><br><span class="line"><span class="comment">	 *       接收请求参数</span></span><br><span class="line"><span class="comment">	 *       等价 request.getParameter("username") String</span></span><br><span class="line"><span class="comment">	 *       例如</span></span><br><span class="line"><span class="comment">	 *       	 String username = <span class="doctag">@RequestParam</span>(value="username")</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/login"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">login</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestParam(value=<span class="string">"username"</span>)</span> String username,</span></span><br><span class="line"><span class="function">			@<span class="title">RequestParam</span><span class="params">(value=<span class="string">"password"</span>)</span> String password</span></span><br><span class="line"><span class="function">			) </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//输出业务信息</span></span><br><span class="line">		System.out.println(<span class="string">"用户名："</span> + username);</span><br><span class="line">		System.out.println(<span class="string">"密码："</span> + password);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//定义跳转视图  springmvc视图类型</span></span><br><span class="line">		ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">		<span class="comment">//跳转视图名称</span></span><br><span class="line">		mv.setViewName(<span class="string">"success"</span>);</span><br><span class="line">		<span class="comment">//默认等价request范围</span></span><br><span class="line">		mv.addObject(<span class="string">"msg"</span>, <span class="string">"第一个springmvc工程"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> mv;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.bean.Register;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *<span class="doctag">@Controller</span></span></span><br><span class="line"><span class="comment"> *   实例化对象  服务端</span></span><br><span class="line"><span class="comment"> *   </span></span><br><span class="line"><span class="comment"> *   <span class="doctag">@RequestMapping</span></span></span><br><span class="line"><span class="comment"> *       作用域</span></span><br><span class="line"><span class="comment"> *          类      ： 命名空间  表示唯一      一般命名：类名  </span></span><br><span class="line"><span class="comment"> *          方法  ： 接收请求地址</span></span><br><span class="line"><span class="comment"> *          /register/register</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/register"</span>)</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@RequestMapping</span></span></span><br><span class="line"><span class="comment">	 *     value属性接收请求</span></span><br><span class="line"><span class="comment">	 *     method属性接收请求类型</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 *     发送register.do请求,必须为post请求类型</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 *     默认什么请求都接收</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 * springmvc集成servlet</span></span><br><span class="line"><span class="comment">	 *     HttpServletRequest</span></span><br><span class="line"><span class="comment">	 *     HttpServletResponse</span></span><br><span class="line"><span class="comment">	 *     HttpSession    request.getSession</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 * 跳转视图 有2种类型</span></span><br><span class="line"><span class="comment">	 *  String</span></span><br><span class="line"><span class="comment">	 *  ModelAndView</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/register"</span>,method=RequestMethod.POST)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">register</span><span class="params">(Register r,HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**********springmvc api**********************/</span></span><br><span class="line">		System.out.println(<span class="string">"用户名："</span> + r.getUsername());</span><br><span class="line">		System.out.println(<span class="string">"密码："</span> + r.getPassword());</span><br><span class="line">		System.out.println(<span class="string">"生日："</span> + r.getBirthDay());</span><br><span class="line">		System.out.println(<span class="string">"性别："</span> + r.getGender());</span><br><span class="line">		</span><br><span class="line">		List&lt;String&gt; hobbys = r.getHobby();</span><br><span class="line">		<span class="keyword">if</span>(hobbys != <span class="keyword">null</span> &amp;&amp; hobbys.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			System.out.print(<span class="string">"爱好："</span>);</span><br><span class="line">			<span class="keyword">for</span>(String hobby : hobbys) &#123;</span><br><span class="line">				System.out.print(hobby + <span class="string">","</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**********servlet api**********************/</span></span><br><span class="line">		System.out.println(<span class="string">"---------------------------"</span>);</span><br><span class="line">		</span><br><span class="line">		String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">		String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">		String birthDay = request.getParameter(<span class="string">"birthDay"</span>);</span><br><span class="line">		String gender   = request.getParameter(<span class="string">"gender"</span>);</span><br><span class="line">		</span><br><span class="line">		String[] hobby = request.getParameterValues(<span class="string">"hobby"</span>); </span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"用户名："</span> + username);</span><br><span class="line">		System.out.println(<span class="string">"密码："</span> + password);</span><br><span class="line">		System.out.println(<span class="string">"生日："</span> + birthDay);</span><br><span class="line">		System.out.println(<span class="string">"性别："</span> + gender);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(hobby.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			System.out.print(<span class="string">"爱好："</span>);</span><br><span class="line">			<span class="keyword">for</span>(String str : hobby) &#123;</span><br><span class="line">				System.out.print(str + <span class="string">","</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//返回视图</span></span><br><span class="line">		request.setAttribute(<span class="string">"msg"</span>, <span class="string">"springmvc接收模型驱动参数"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*public String registerBAK(</span></span><br><span class="line"><span class="comment">			@RequestParam("username") String username,</span></span><br><span class="line"><span class="comment">			@RequestParam("password") String password,</span></span><br><span class="line"><span class="comment">			@RequestParam("gender") Integer gender,</span></span><br><span class="line"><span class="comment">			@RequestParam("hobby") List&lt;String&gt; hobby,</span></span><br><span class="line"><span class="comment">			@RequestParam("birthDay") @DateTimeFormat(pattern="yyyy-MM-dd") Date brithDay,</span></span><br><span class="line"><span class="comment">			HttpServletRequest request) &#123;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		return null;</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Springmvc-的request域和session域-amp-amp-乱码处理"><a href="#Springmvc-的request域和session域-amp-amp-乱码处理" class="headerlink" title="Springmvc 的request域和session域&amp;&amp;乱码处理"></a>Springmvc 的request域和session域&amp;&amp;乱码处理</h4><ul>
<li>web.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>springmvc01<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 请求 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 响应 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 end --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- springmvc start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		默认加载springmvc配置文件路径为：</span></span><br><span class="line"><span class="comment">  				WEB-INF/[servlet-name]-serlvet.xml</span></span><br><span class="line"><span class="comment">  	 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springmvc end --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>springmvc的xml文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		扫描ioc注解</span></span><br><span class="line"><span class="comment">			@Controller</span></span><br><span class="line"><span class="comment">		      spring 实例化</span></span><br><span class="line"><span class="comment">              springmvc 实例化 服务端</span></span><br><span class="line"><span class="comment">		    @Service @Repository @Autowired等</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		当前扫描操作不是spring ，是springmvc</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		多个bean元素 </span></span><br><span class="line"><span class="comment">		映射器(请求)、适配器（执行方法）、类型转换 （参数、json）</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		视图解析器 </span></span><br><span class="line"><span class="comment">		/success.jsp</span></span><br><span class="line"><span class="comment">		forward:/success.jsp</span></span><br><span class="line"><span class="comment">		forward:/forwardView.do</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>前端  jsp 页面(发送请求)</p>
<p>forwardAdnRedirect.jsp</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/forwardView.do"</span>&gt;</span></span><br><span class="line">		请求转发</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/forwardView2.do"</span>&gt;</span></span><br><span class="line">		请求转发后台访问后台请求</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/redirectView.do"</span>&gt;</span></span><br><span class="line">		重定向</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/redirectView2.do"</span>&gt;</span></span><br><span class="line">		重定向后台访问后台请求</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>controller</strong></p>
<p>GetSessionController</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.SessionAttributes;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SessionAttributes</span>(value=&#123;<span class="string">"m_model"</span>,<span class="string">"mm_modelmap"</span>&#125;)</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetSessionController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"getSession"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getSession</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			Model m,ModelMap mm,</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpSession session)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//model没有get方法获取信息</span></span><br><span class="line">		<span class="comment">//需要通过modelmap的get方法来获取model信息</span></span><br><span class="line">		String m_model = (String)mm.get(<span class="string">"m_model"</span>);</span><br><span class="line">		</span><br><span class="line">		String mm_modelmap = (String)mm.get(<span class="string">"mm_modelmap"</span>);</span><br><span class="line">		</span><br><span class="line">		String servelt_session = </span><br><span class="line">				(String)session.getAttribute(<span class="string">"servelt_session"</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"通过modelmap获取model信息："</span> + m_model);</span><br><span class="line">		System.out.println(<span class="string">"获取modelmap信息："</span> + mm_modelmap);</span><br><span class="line">		System.out.println(<span class="string">"获取servlet，session信息："</span> + servelt_session);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		session.setAttribute(<span class="string">"msg"</span>, <span class="string">"测试session范围"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>RequestController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Springmvc 内置对象  缺省 等价 默认值</span></span><br><span class="line"><span class="comment">	 * Model ModelMap  默认为request范围</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/requestScope"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">requestScope</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			Model m,ModelMap mm,</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**********springmvc  api******************/</span></span><br><span class="line">		</span><br><span class="line">		m.addAttribute(<span class="string">"m_model"</span>, <span class="string">"etoak"</span>);</span><br><span class="line">		mm.addAttribute(<span class="string">"mm_modelmap"</span>, <span class="string">"et1801"</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		mm.addAttribute(<span class="string">"msg"</span>, <span class="string">"测试modelmap-springmvc"</span>);</span><br><span class="line">		m.addAttribute(<span class="string">"msg"</span>, <span class="string">"测试model-springmvc"</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**********servlet  api******************/</span></span><br><span class="line">		</span><br><span class="line">		request.setAttribute(<span class="string">"req"</span>, <span class="string">"易途"</span>);</span><br><span class="line">		request.setAttribute(<span class="string">"msg"</span>, <span class="string">"测试-servlet"</span>);</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"requestScope"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SetSessionController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.SessionAttributes;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将model和modelmap转换成session范围</span></span><br><span class="line"><span class="meta">@SessionAttributes</span>(value=&#123;<span class="string">"m_model"</span>,<span class="string">"mm_modelmap"</span>&#125;)</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SetSessionController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * ModelMap  Model 默认request范围</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/sessionScope"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">sessionScope</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			Model m,ModelMap mm,</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpSession session)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/***********springmvc api********************/</span></span><br><span class="line">		</span><br><span class="line">		m.addAttribute(<span class="string">"m_model"</span>, <span class="string">"易途"</span>);</span><br><span class="line">		mm.addAttribute(<span class="string">"mm_modelmap"</span>, <span class="string">"et1803"</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/***********servlet api********************/</span></span><br><span class="line">		</span><br><span class="line">		session.setAttribute(<span class="string">"servelt_session"</span>, <span class="string">"etoak"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"sessionScope"</span>;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ForwardAndRedirectController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardAndRedirectController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 测试请求转发</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/forwardView"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">forwardView</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		request.setAttribute(<span class="string">"msg"</span>, <span class="string">"测试请求转发"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//forward:表示springmvc提供请求转发状态码  不能写错 固定写法</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">"forward:/success.jsp"</span>;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 请求转发后台访问后台请求</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"forwardView2"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">forwardView2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"forward:/forwardView.do"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*********************************************/</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 测试重定向</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/redirectView"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">redirectView</span><span class="params">(HttpSession session)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		session.setAttribute(<span class="string">"msg"</span>, <span class="string">"测试重定向"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//redirect:表示springmvc提供重定向状态码  不能写错 固定写法</span></span><br><span class="line">		<span class="comment">//重定向不接收request范围信息</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">"redirect:/success.jsp"</span>;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *	重定向后台访问后台请求</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/redirectView2"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">redirectView2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"redirect:/redirectView.do"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>jsp 页面   （取出域中的数据）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">scope.jsp------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/requestScope.do"</span>&gt;</span></span><br><span class="line">		request范围</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/sessionScope.do"</span>&gt;</span></span><br><span class="line">		session范围</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">sessionScope.jsp------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/requestScope.do"</span>&gt;</span></span><br><span class="line">		request范围</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/sessionScope.do"</span>&gt;</span></span><br><span class="line">		session范围</span><br><span class="line">	<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">success.jsp-------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">成功！！！！！</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">$&#123;msg &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">requestScope.jsp---------------</span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   springmvc api :</span><br><span class="line">	    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	    $&#123;m_model &#125;</span><br><span class="line">	    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	    $&#123;mm_modelmap &#125;</span><br><span class="line">	    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">   servelt api :</span><br><span class="line">	    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	    $&#123;req &#125;</span><br><span class="line">	    </span><br><span class="line">	    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	    $&#123;msg &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="文件上传和下载"><a href="#文件上传和下载" class="headerlink" title="文件上传和下载"></a>文件上传和下载</h4><p>Web项目中，文件上传功能几乎是必不可少的，实现的技术有很多，今天我们来学习如何使用SpringMVC框架完成文件的上传以及下载。</p>
<h5 id="代码示例1：-1"><a href="#代码示例1：-1" class="headerlink" title="代码示例1："></a>代码示例1：</h5><p>单文件上传</p>
<p>1.底层使用的是Apache fileupload组件完成上传，SpringMVC只是进行了封装，让开发者使用起来更加方便，所以首先需要引入fileupload组件的依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;commons-io&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.3.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>2.JSP</p>
<p>1.input的type设置为file。</p>
<p>2.form表单的method设置为post。（get请求只会将文件名传给后台）</p>
<p>3.form表单的enctype设置为multipart/form-data，以二进制的形式传输数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    String path = request.getContextPath();</span><br><span class="line">    String basePath = request.getScheme()+&quot;://&quot;+request.getServerName()+&quot;:&quot;+request.getServerPort()+path+&quot;/&quot;;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=&quot;upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;img&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;&lt;br /&gt; </span><br><span class="line">    &lt;c:if test=&quot;$&#123;filePath!=null &#125;&quot;&gt;</span><br><span class="line">        &lt;h1&gt;上传的图片&lt;/h1&gt;&lt;br /&gt; </span><br><span class="line">        &lt;img width=&quot;300px&quot; src=&quot;&lt;%=basePath %&gt;$&#123;filePath&#125;&quot;/&gt;</span><br><span class="line">    &lt;/c:if&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>如果上传成功，返回当前页面，展示上传成功的图片，这里需要使用JSTL标签进行判断。</p>
<p>pom文件中引入JSTL依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;jstl&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;taglibs&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;standard&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.1.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>3.业务方法，使用MultipartFile对象作为参数，接收前端发送过来的文件，并完成上传操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> @RequestMapping(value=&quot;/upload&quot;, method = RequestMethod.POST)</span><br><span class="line"> public String upload(@RequestParam(value=&quot;img&quot;)MultipartFile img, HttpServletRequest request)</span><br><span class="line">         throws Exception &#123;</span><br><span class="line">     //getSize()方法获取文件的大小来判断是否有上传文件</span><br><span class="line">     if (img.getSize() &gt; 0) &#123;</span><br><span class="line">        //获取保存上传文件的file文件夹绝对路径</span><br><span class="line">        String path = request.getSession().getServletContext().getRealPath(&quot;file&quot;);</span><br><span class="line">        //获取上传文件名</span><br><span class="line">        String fileName = img.getOriginalFilename();</span><br><span class="line">        File file = new File(path, fileName);</span><br><span class="line">        img.transferTo(file);</span><br><span class="line">        //保存上传之后的文件路径</span><br><span class="line">        request.setAttribute(&quot;filePath&quot;, &quot;file/&quot;+fileName);</span><br><span class="line">        return &quot;upload&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">    return &quot;error&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.springmvc.xml配置CommonsMultipartResolver。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置CommonsMultipartResolver bean，id必须是multipartResolver --&gt;</span><br><span class="line">&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;</span><br><span class="line">    &lt;!-- 处理文件名中文乱码 --&gt;</span><br><span class="line">    &lt;property name=&quot;defaultEncoding&quot; value=&quot;utf-8&quot;/&gt;</span><br><span class="line">    &lt;!-- 设置多文件上传，总大小上限，不设置默认没有限制，单位为字节，1M=1*1024*1024 --&gt;</span><br><span class="line">    &lt;property name=&quot;maxUploadSize&quot; value=&quot;1048576&quot;/&gt;</span><br><span class="line">    &lt;!-- 设置每个上传文件的大小上限 --&gt;</span><br><span class="line">    &lt;property name=&quot;maxUploadSizePerFile&quot; value=&quot;1048576&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 设置异常解析器 --&gt;</span><br><span class="line">&lt;bean class=&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;defaultErrorView&quot; value=&quot;/error.jsp&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>5.运行。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtceyNATlmsicfhiauYqgiaznUupVjiaJolgafjl0Dn1iasBViaAHyb1TubTqA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtM0jnlF2N1icRhYKQt5dibNpW1DH8DdIBictZyl3Jkf0bDDal7lCGia2ckA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>多文件上传</p>
<p>1.JSP。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    String path = request.getContextPath();</span><br><span class="line">    String basePath = request.getScheme()+&quot;://&quot;+request.getServerName()+&quot;:&quot;+request.getServerPort()+path+&quot;/&quot;;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=&quot;uploads&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        file1:&lt;input type=&quot;file&quot; name=&quot;imgs&quot;&gt;&lt;br /&gt;</span><br><span class="line">        file2:&lt;input type=&quot;file&quot; name=&quot;imgs&quot;&gt;&lt;br /&gt; </span><br><span class="line">        file3:&lt;input type=&quot;file&quot; name=&quot;imgs&quot;&gt;&lt;br /&gt;  </span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;c:if test=&quot;$&#123;filePaths!=null &#125;&quot;&gt;</span><br><span class="line">        &lt;h1&gt;上传的图片&lt;/h1&gt;&lt;br /&gt; </span><br><span class="line">        &lt;c:forEach items=&quot;$&#123;filePaths &#125;&quot; var=&quot;filePath&quot;&gt;</span><br><span class="line">            &lt;img width=&quot;300px&quot; src=&quot;&lt;%=basePath %&gt;$&#123;filePath&#125;&quot;/&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/c:if&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>2.业务方法，使用MultipartFile数组对象接收上传的多个文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value=&quot;/uploads&quot;, method = RequestMethod.POST)</span><br><span class="line">public String uploads(@RequestParam MultipartFile[] imgs, HttpServletRequest request)</span><br><span class="line">        throws Exception &#123;</span><br><span class="line">    //创建集合，保存上传后的文件路径</span><br><span class="line">    List&lt;String&gt; filePaths = new ArrayList&lt;String&gt;();</span><br><span class="line">    for (MultipartFile img : imgs) &#123;</span><br><span class="line">        if (img.getSize() &gt; 0) &#123;</span><br><span class="line">           String path = request.getSession().getServletContext().getRealPath(&quot;file&quot;);</span><br><span class="line">           String fileName = img.getOriginalFilename();</span><br><span class="line">           File file = new File(path, fileName);</span><br><span class="line">           filePaths.add(&quot;file/&quot;+fileName);</span><br><span class="line">           img.transferTo(file);</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    request.setAttribute(&quot;filePaths&quot;, filePaths);</span><br><span class="line">    return &quot;uploads&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.运行。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtRMcNpKNQaW72qlhO5hib3rxgqu9ervic8PQ6ad8l6hgsGKZm8E6LllVQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtyO9X1JsTEcIcyRIibNy7ib254apm3krJVe8SEUib27jpO0VUY89iaBny1w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<p>文件下载</p>
<p>1.JSP，使用超链接，下载之前上传的logo.jpg。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=&quot;download?fileName=logo.jpg&quot;&gt;下载图片&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>2.业务方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> @RequestMapping(&quot;/download&quot;)</span><br><span class="line"> public void downloadFile(String fileName,HttpServletRequest request,</span><br><span class="line">      HttpServletResponse response)&#123;</span><br><span class="line">    if(fileName!=null)&#123;</span><br><span class="line">      //获取file绝对路径</span><br><span class="line">      String realPath = request.getServletContext().getRealPath(&quot;file/&quot;);</span><br><span class="line">      File file = new File(realPath,fileName);</span><br><span class="line">      OutputStream out = null;</span><br><span class="line">      if(file.exists())&#123;</span><br><span class="line">         //设置下载完毕不打开文件 </span><br><span class="line">         response.setContentType(&quot;application/force-download&quot;);</span><br><span class="line">         //设置文件名 </span><br><span class="line">         response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot;+fileName);</span><br><span class="line">         try &#123;</span><br><span class="line">            out = response.getOutputStream();</span><br><span class="line">            out.write(FileUtils.readFileToByteArray(file));</span><br><span class="line">            out.flush();</span><br><span class="line">         &#125; catch (IOException e) &#123;</span><br><span class="line">            // TODO Auto-generated catch block</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">         &#125;finally&#123;</span><br><span class="line">             if(out != null)&#123;</span><br><span class="line">                 try &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    // TODO Auto-generated catch block</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;                    </span><br><span class="line">      &#125;           </span><br><span class="line">   &#125;           </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.运行。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/t4kgaKYXPLdrtoibY9DbnfVss0EsRuVKtywMP11oSvsficuicg82nxEsxv44jJ9wBbbVVQ60UP0ZnFV25UMiaFlc1Q/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt="img"></p>
<h5 id="代码示例2：-2"><a href="#代码示例2：-2" class="headerlink" title="代码示例2："></a>代码示例2：</h5><ul>
<li>配置文件</li>
</ul>
<p>​         web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>springmvc01<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 请求 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 响应 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 end --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- springmvc start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		默认加载springmvc配置文件路径为：</span></span><br><span class="line"><span class="comment">  				WEB-INF/[servlet-name]-serlvet.xml</span></span><br><span class="line"><span class="comment">  	 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springmvc end --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>etoak-servlet.xml   (springmvc的配置文件)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		扫描ioc注解</span></span><br><span class="line"><span class="comment">			@Controller</span></span><br><span class="line"><span class="comment">		      spring 实例化</span></span><br><span class="line"><span class="comment">              springmvc 实例化 服务端</span></span><br><span class="line"><span class="comment">		    @Service @Repository @Autowired等</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		当前扫描操作不是spring ，是springmvc</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		多个bean元素 </span></span><br><span class="line"><span class="comment">		映射器(请求)、适配器（执行方法）、类型转换 （参数、json）</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		视图解析器 </span></span><br><span class="line"><span class="comment">		/success.jsp</span></span><br><span class="line"><span class="comment">		forward:/success.jsp</span></span><br><span class="line"><span class="comment">		forward:/forwardView.do</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		上传解析器</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		getBean("multipartResolver")</span></span><br><span class="line"><span class="comment">		注意事项 id必须为  id="multipartResolver"</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 默认编码为ISO-8859-1 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> </span></span><br><span class="line"><span class="tag">					<span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 设置上传大小  单位b  3M-5M  3*1024*1204--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> </span></span><br><span class="line"><span class="tag">		            <span class="attr">value</span>=<span class="string">"3000000"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>jsp页面</p>
<p>upload.jsp</p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- </span><br><span class="line">       	 批量上传</span><br><span class="line">    	ajaxFileUpload.js</span><br><span class="line">    	jquery.uploadify.js</span><br><span class="line">    	webupload.js   </span><br><span class="line">    	jquery.zTree.js</span><br><span class="line">     --&gt;</span><br><span class="line">	&lt;form action=<span class="string">"$&#123;pageContext.request.contextPath &#125;/upload.do"</span></span><br><span class="line">	      method=<span class="string">"post"</span></span><br><span class="line">	      enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;input type=<span class="string">"file"</span> name=<span class="string">"f"</span> /&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;input type=<span class="string">"submit"</span> value=<span class="string">"上传"</span> /&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;form action=<span class="string">"$&#123;pageContext.request.contextPath &#125;/uploadFtp.do"</span></span><br><span class="line">	      method=<span class="string">"post"</span></span><br><span class="line">	      enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;input type=<span class="string">"file"</span> name=<span class="string">"f"</span> /&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;input type=<span class="string">"submit"</span> value=<span class="string">"上传ftp"</span> /&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p> download.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- </span><br><span class="line">		# 空连接  会刷新页面 跳转当前页面</span><br><span class="line">		javascript:<span class="keyword">void</span>();  不会刷新页面</span><br><span class="line">	 --&gt;</span><br><span class="line">	&lt;a href=<span class="string">"$&#123;pageContext.request.contextPath &#125;/download.do?fileName=$&#123;fileName&#125;"</span>&gt;</span><br><span class="line">		下载</span><br><span class="line">	&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;br/&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;a href=<span class="string">"$&#123;pageContext.request.contextPath &#125;/downloadFtp.do?fileName=$&#123;fileName&#125;"</span>&gt;</span><br><span class="line">		下载ftp</span><br><span class="line">	&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>controller</li>
<li>上传</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FilenameUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.util.FtpUtil;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span><span class="comment">//实例化对象  服务端</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * MultipartFile 上传使用的类型</span></span><br><span class="line"><span class="comment">	 * 上传文件保存有3种方式</span></span><br><span class="line"><span class="comment">	 * 1.将上传的文件信息保存到服务端（tomcat）</span></span><br><span class="line"><span class="comment">	 *    缺点：每次服务器重启  上传信息丢失</span></span><br><span class="line"><span class="comment">	 * 2.持久化 将上传文件保存到数据库表中</span></span><br><span class="line"><span class="comment">	 *      java      数据库表</span></span><br><span class="line"><span class="comment">	 *      byte[]    orcale:blob    mysql:longblob </span></span><br><span class="line"><span class="comment">	 * 3.ftp   上传文件协议     服务器</span></span><br><span class="line"><span class="comment">	 *     在当前的pc端保存到另一个pc端</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/upload"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestParam(value=<span class="string">"f"</span>)</span> MultipartFile f,</span></span><br><span class="line"><span class="function">			HttpSession session) </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"上传文件的类型："</span> + f.getContentType());</span><br><span class="line">		System.out.println(<span class="string">"上传文件请求参数名称："</span> + f.getName());</span><br><span class="line">		System.out.println(<span class="string">"上传文件名称："</span> + f.getOriginalFilename());</span><br><span class="line">		System.out.println(<span class="string">"上传文件的大小"</span> + f.getSize());</span><br><span class="line">		<span class="comment">//true为空   false不为空</span></span><br><span class="line">		System.out.println(<span class="string">"上传文件是否为空："</span> + f.isEmpty());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//判断上传文件是否为空</span></span><br><span class="line">		<span class="keyword">if</span>(f != <span class="keyword">null</span> &amp;&amp; !f.isEmpty() &amp;&amp; f.getSize() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取上传文件保存路径</span></span><br><span class="line">			ServletContext sc = session.getServletContext();</span><br><span class="line">			String path = sc.getRealPath(<span class="string">"/files"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取文件路径</span></span><br><span class="line">			File file = <span class="keyword">new</span> File(path);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//判断路径是否存在</span></span><br><span class="line">			<span class="keyword">if</span>(!file.exists()) &#123;</span><br><span class="line">				<span class="comment">//创建保存文件路径</span></span><br><span class="line">				file.mkdirs();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//随机生成信息</span></span><br><span class="line">			String uuid = UUID.randomUUID().toString();</span><br><span class="line">			<span class="comment">//获取上传文件后缀名称    et1803.txt   txt</span></span><br><span class="line">			String suffix = </span><br><span class="line">					FilenameUtils.getExtension(f.getOriginalFilename());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//组装上传文件名称</span></span><br><span class="line">			String fileName = uuid + <span class="string">"."</span> + suffix;</span><br><span class="line">			</span><br><span class="line">		<span class="comment">/*	try &#123;</span></span><br><span class="line"><span class="comment">				//将二进制信息上传到指定保存路径</span></span><br><span class="line"><span class="comment">				f.transferTo(new File(path,fileName));</span></span><br><span class="line"><span class="comment">			&#125; catch (IllegalStateException | IOException e) &#123;</span></span><br><span class="line"><span class="comment">				e.printStackTrace();</span></span><br><span class="line"><span class="comment">			&#125;*/</span></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">try</span>(</span><br><span class="line">				<span class="comment">//获取上传二进制流信息</span></span><br><span class="line">				InputStream is = f.getInputStream();</span><br><span class="line">				<span class="comment">//输出上传文件信息，并保存到指定路径</span></span><br><span class="line">				OutputStream out = </span><br><span class="line">						<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(path,fileName));</span><br><span class="line">			) &#123;</span><br><span class="line">				<span class="comment">//定义缓存信息   </span></span><br><span class="line">				<span class="comment">//is.available()上传文件的大小  缓冲的长度</span></span><br><span class="line">				<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()];</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//读取上传信息  等于-1表示读取到最后一个字节</span></span><br><span class="line">				<span class="keyword">while</span>(is.read(b) != -<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="comment">//输出上传信息</span></span><br><span class="line">					out.write(b);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取上传二进制字节信息</span></span><br><span class="line">			<span class="comment">//byte[] b = f.getBytes();</span></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"download"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/uploadFtp"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">uploadFtp</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestParam(value=<span class="string">"f"</span>)</span> MultipartFile f) </span>&#123;</span><br><span class="line">		</span><br><span class="line">	    <span class="comment">//通过ftp上传文件信息</span></span><br><span class="line">		<span class="comment">//考虑压缩</span></span><br><span class="line">		FtpUtil ftp = FtpUtil.getInstance();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">//true上传成功  false上传失败</span></span><br><span class="line">		<span class="keyword">boolean</span> b = ftp.upload(</span><br><span class="line">					<span class="string">"127.0.0.1"</span>, <span class="number">21</span>, </span><br><span class="line">					<span class="string">"ay2853"</span>, <span class="string">"123456"</span>, </span><br><span class="line">					<span class="string">"D:/ftp"</span>, <span class="comment">//服务器保存上传文件路径</span></span><br><span class="line">					f.getOriginalFilename(), </span><br><span class="line">					f.getInputStream());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//判断上传是否成功</span></span><br><span class="line">		<span class="keyword">if</span>(!b) &#123;</span><br><span class="line">			System.out.println(<span class="string">"上传失败"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"download"</span>;</span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>下载</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.util.FtpUtil;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/download"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestParam(value=<span class="string">"fileName"</span>)</span> String fileName,</span></span><br><span class="line"><span class="function">			HttpSession session,</span></span><br><span class="line"><span class="function">			HttpServletResponse response) </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取下载附件路径</span></span><br><span class="line">		ServletContext sc = session.getServletContext();</span><br><span class="line">		String path = sc.getRealPath(<span class="string">"/files"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取下载附件原名称</span></span><br><span class="line">		String originalFilename = </span><br><span class="line">				(String)session.getAttribute(<span class="string">"originalFilename"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//定义响应头信息   针对下载</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			response.addHeader(</span><br><span class="line">					<span class="string">"content-disposition"</span>, </span><br><span class="line">					<span class="string">"attachment;filename="</span> + </span><br><span class="line">					<span class="keyword">new</span> String(originalFilename.getBytes(<span class="string">"GB2312"</span>),<span class="string">"ISO-8859-1"</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span>(</span><br><span class="line">			<span class="comment">//读取下载附件信息</span></span><br><span class="line">			InputStream is = </span><br><span class="line">				<span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(path,fileName));</span><br><span class="line">			<span class="comment">//响应下载信息对象</span></span><br><span class="line">		    OutputStream out = response.getOutputStream();</span><br><span class="line">		) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//定义缓存信息</span></span><br><span class="line">			<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()];</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//读取下载附件信息，并输出响应给浏览器</span></span><br><span class="line">			<span class="keyword">while</span>(is.read(b) != -<span class="number">1</span>) &#123;</span><br><span class="line">				out.write(b);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/downloadFtp"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">downloadFtp</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestParam(value=<span class="string">"fileName"</span>)</span> String fileName,</span></span><br><span class="line"><span class="function">			HttpServletResponse response) </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//decoder解密</span></span><br><span class="line">		String originalFilename = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			originalFilename = URLDecoder.decode(</span><br><span class="line">					URLDecoder.decode(fileName, <span class="string">"UTF-8"</span>),</span><br><span class="line">					<span class="string">"UTF-8"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e2) &#123;</span><br><span class="line">			e2.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//定义响应头信息   针对下载</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			response.addHeader(</span><br><span class="line">					<span class="string">"content-disposition"</span>, </span><br><span class="line">					<span class="string">"attachment;filename="</span> + </span><br><span class="line">					<span class="keyword">new</span> String(originalFilename.getBytes(<span class="string">"GB2312"</span>),<span class="string">"ISO-8859-1"</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span>(</span><br><span class="line">			<span class="comment">//读取下载附件信息</span></span><br><span class="line">			InputStream is = </span><br><span class="line">				FtpUtil.getInstance()</span><br><span class="line">				.download(</span><br><span class="line">						<span class="string">"127.0.0.1"</span>, <span class="number">21</span>,</span><br><span class="line">						<span class="string">"ay2853"</span>, <span class="string">"123456"</span>, </span><br><span class="line">						<span class="string">"D:/ftp"</span>, originalFilename);</span><br><span class="line">			<span class="comment">//响应下载信息对象</span></span><br><span class="line">		    OutputStream out = response.getOutputStream();</span><br><span class="line">		) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//定义缓存信息</span></span><br><span class="line">			<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()];</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//读取下载附件信息，并输出响应给浏览器</span></span><br><span class="line">			<span class="keyword">while</span>(is.read(b) != -<span class="number">1</span>) &#123;</span><br><span class="line">				out.write(b);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>######FtpUtil.java    (向ftp服务器上上传数据的工具类)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPReply;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FtpUtil</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">FtpUtil</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">	<span class="comment">//输出日志</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger logger = Logger.getLogger(FtpUtil.class.getName());</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//创建FTPClient对象</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> FTPClient ftp = <span class="keyword">new</span> FTPClient();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义FtpUtil对象</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> FtpUtil INSTANCE = <span class="keyword">null</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//单例模式 创建FtpUtil对象 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FtpUtil <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(INSTANCE == <span class="keyword">null</span>) &#123;</span><br><span class="line">			 <span class="keyword">synchronized</span> (FtpUtil.class) &#123;</span><br><span class="line">				 <span class="keyword">if</span>(INSTANCE == <span class="keyword">null</span>) &#123;</span><br><span class="line">					 INSTANCE = <span class="keyword">new</span> FtpUtil();</span><br><span class="line">				 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> INSTANCE;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 上传</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> hostname ip地址</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> port     端口号  ftp默认为21</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> username ftp用户名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password ftp密码</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ftppath  磁盘保存路径</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> filename 保存文件名称</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> input    上传二进制信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">upload</span><span class="params">(String hostname,<span class="keyword">int</span> port,String username,String password,</span></span></span><br><span class="line"><span class="function"><span class="params">						  String ftppath,String filename,InputStream input)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">        	<span class="comment">//设置编码为UTF-8</span></span><br><span class="line"> 			ftp.setControlEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        	<span class="comment">// 连接FTP服务器   ftp://localhost:21</span></span><br><span class="line">			ftp.connect(hostname, port);</span><br><span class="line">			<span class="comment">// 登陆FTP服务器   ay2853 123456</span></span><br><span class="line">			ftp.login(username, password);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//判断是否连接 连接尝试后的查询</span></span><br><span class="line">			<span class="keyword">if</span>(disConnect()) &#123;</span><br><span class="line">				logger.info(<span class="string">"上传未连接到FTP，关闭资源"</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置类型为二进制文件</span></span><br><span class="line">			ftp.setFileType(FTPClient.BINARY_FILE_TYPE);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置上传目录   转移到FTP服务器目录  </span></span><br><span class="line">			ftp.enterLocalPassiveMode();  </span><br><span class="line">            ftp.changeWorkingDirectory(ftppath);  </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//保存上传信息</span></span><br><span class="line">            <span class="keyword">return</span> ftp.storeFile(filename, input);           </span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//关闭上传信息</span></span><br><span class="line">				input.close();</span><br><span class="line">				<span class="comment">//打开连接之后 退出登录</span></span><br><span class="line">				logout();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">         </span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 下载</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> hostname ip地址</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> port     端口号  ftp默认为21</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> username ftp用户名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password ftp密码</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ftppath  磁盘保存路径</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> filename 保存文件名称</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> InputStream <span class="title">download</span><span class="params">(String hostname,<span class="keyword">int</span> port,String username,String password,</span></span></span><br><span class="line"><span class="function"><span class="params">						  String ftppath,String filename)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">        	<span class="comment">//设置编码为UTF-8</span></span><br><span class="line"> 			ftp.setControlEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        	<span class="comment">// 连接FTP服务器  </span></span><br><span class="line">			ftp.connect(hostname, port);</span><br><span class="line">			<span class="comment">// 登陆FTP服务器  </span></span><br><span class="line">			ftp.login(username, password);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//判断是否连接 连接尝试后的查询</span></span><br><span class="line">			<span class="keyword">if</span>(disConnect()) &#123;</span><br><span class="line">				logger.info(<span class="string">"下载未连接到FTP，关闭资源"</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置类型为二进制文件</span></span><br><span class="line">			ftp.setFileType(FTPClient.BINARY_FILE_TYPE);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置上传目录   转移到FTP服务器目录  </span></span><br><span class="line">			ftp.enterLocalPassiveMode();  </span><br><span class="line">            ftp.changeWorkingDirectory(ftppath);  </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//下载上传信息</span></span><br><span class="line">           <span class="keyword">return</span> ftp.retrieveFileStream(filename);      </span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//打开连接之后 退出登录</span></span><br><span class="line">				logout();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">         </span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 删除</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> hostname ip地址</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> port     端口号  ftp默认为21</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> username ftp用户名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password ftp密码</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ftppath  磁盘保存路径</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> filename 保存文件名称</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(String hostname,<span class="keyword">int</span> port,String username,String password,</span></span></span><br><span class="line"><span class="function"><span class="params">						  String ftppath,String filename)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">        	<span class="comment">//设置编码为UTF-8</span></span><br><span class="line"> 			ftp.setControlEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        	<span class="comment">// 连接FTP服务器  </span></span><br><span class="line">			ftp.connect(hostname, port);</span><br><span class="line">			<span class="comment">// 登陆FTP服务器  </span></span><br><span class="line">			ftp.login(username, password);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//判断是否连接 连接尝试后的查询</span></span><br><span class="line">			<span class="keyword">if</span>(disConnect()) &#123;</span><br><span class="line">				logger.info(<span class="string">"删除未连接到FTP，关闭资源"</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置类型为二进制文件</span></span><br><span class="line">			ftp.setFileType(FTPClient.BINARY_FILE_TYPE);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置上传目录   转移到FTP服务器目录  </span></span><br><span class="line">			ftp.enterLocalPassiveMode();  </span><br><span class="line">            ftp.changeWorkingDirectory(ftppath);  </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//删除上传信息</span></span><br><span class="line">           <span class="keyword">return</span> ftp.deleteFile(filename);   </span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//打开连接之后 退出登录</span></span><br><span class="line">				logout();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">         </span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//连接尝试后的查询  true表示未连接 false表示已连接</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">disConnect</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">boolean</span> b = !FTPReply.isPositiveCompletion(ftp.getReplyCode());</span><br><span class="line">		 <span class="keyword">if</span> (b) &#123;  </span><br><span class="line">			 logger.info(<span class="string">"未连接到FTP，用户名或密码错误。"</span>);</span><br><span class="line">			 <span class="comment">//关闭连接</span></span><br><span class="line">             ftp.disconnect();  </span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        	 logger.info(<span class="string">"FTP连接成功。"</span>);  </span><br><span class="line">         &#125;</span><br><span class="line">		 </span><br><span class="line">		 <span class="keyword">return</span> b;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//退出</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logout</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//打开连接之后 退出登录</span></span><br><span class="line">		<span class="keyword">if</span>(ftp.isConnected()) &#123;</span><br><span class="line">			<span class="comment">//ftp退出登录</span></span><br><span class="line">			ftp.logout();</span><br><span class="line">			logger.info(<span class="string">"FTP退出成功。"</span>);  </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		FtpUtil ftpUtil = FtpUtil.getInstance();</span><br><span class="line">		<span class="comment">//测试上传</span></span><br><span class="line">		<span class="comment">/*InputStream input = new FileInputStream("E:/1.txt");</span></span><br><span class="line"><span class="comment">		ftpUtil.upload("127.0.0.1", 21, "ay2853", "2853", "D:/server/ftp", "测试1.txt", input);*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//测试下载</span></span><br><span class="line">		<span class="comment">/*InputStream input = ftpUtil.download("127.0.0.1", 21, "ay2853", "2853", "D:/server/ftp", "测试1.txt");</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		OutputStream out = new FileOutputStream("E:/测试1.txt");</span></span><br><span class="line"><span class="comment">		byte[] b = new byte[input.available()];</span></span><br><span class="line"><span class="comment">		while(input.read(b) != -1) &#123;</span></span><br><span class="line"><span class="comment">			out.write(b);</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//测试删除</span></span><br><span class="line">		<span class="comment">//ftpUtil.remove("127.0.0.1", 21, "ay2853", "2853", "D:/server/ftp", "测试1.txt");</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//out.flush();</span></span><br><span class="line">		<span class="comment">//out.close();</span></span><br><span class="line">		<span class="comment">//input.close();</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ajax-amp-json"><a href="#ajax-amp-json" class="headerlink" title="ajax  &amp; json"></a>ajax  &amp; json</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line"> 		springmvc 只兼容2种请求格式</span><br><span class="line"> 		1. *.do   *.action</span><br><span class="line"> 			禁止使用 *.html   不兼容json格式</span><br><span class="line"> 		2. 斜杠(/) </span><br><span class="line"> 		        禁止使用/*</span><br><span class="line"> 		        使用/请求 表示springmvc集成restful</span><br><span class="line"> 		        使用/请求 默认不加载静态资源   js、css、&lt;img&gt;</span><br><span class="line"> 	--&gt;</span><br></pre></td></tr></table></figure>
<p>  1.导包</p>
<p><img src="C:\Users\ADMINI~1\AppData\Local\Temp\1529581617532.png" alt="1529581617532"></p>
<ol>
<li>引入js文件</li>
</ol>
<h6 id="代码示例1"><a href="#代码示例1" class="headerlink" title="代码示例1:"></a>代码示例1:</h6><ul>
<li>web.xml          =&gt;  要设置请求的url</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>springmvc01<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 请求 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 响应 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 end --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- springmvc start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		默认加载springmvc配置文件路径为：</span></span><br><span class="line"><span class="comment">  				WEB-INF/[servlet-name]-serlvet.xml</span></span><br><span class="line"><span class="comment">  	 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 自定义加载springmvc配置文件路径 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:etoak-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		springmvc 只兼容2种请求格式</span></span><br><span class="line"><span class="comment">  		1. *.do   *.action</span></span><br><span class="line"><span class="comment">  			禁止使用 *.html   不兼容json格式</span></span><br><span class="line"><span class="comment">  		2. 斜杠(/) </span></span><br><span class="line"><span class="comment">  		        禁止使用/*</span></span><br><span class="line"><span class="comment">  		        使用/请求 表示springmvc集成restful</span></span><br><span class="line"><span class="comment">  		        使用/请求 默认不加载静态资源   js、css、&lt;img&gt;</span></span><br><span class="line"><span class="comment">  	--&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springmvc end --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>etoak-servlet.xml     ( springmvc的配置文件) </p>
<blockquote>
<p>在springmvc配置文件中设置，配置加载静态资源</p>
<p>​        </p>
<pre><code>&lt;!-- 
        /请求    加载静态资源 js css &lt;img&gt; 

        *.do请求不需要配置静态资源加载
    location属性表示当前工程需要映射的路径
    mapping属性表示映射加载location属性指定的路径，
            加载静态资源文件 js css &lt;img&gt;

    *表示一层目录    /js/*    /js/js1/
    **表示多层目录 /js/**   /js/js1/js2/js3/js4/
--&gt;
</code></pre></blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		扫描ioc注解</span></span><br><span class="line"><span class="comment">			@Controller</span></span><br><span class="line"><span class="comment">		      spring 实例化</span></span><br><span class="line"><span class="comment">              springmvc 实例化 服务端</span></span><br><span class="line"><span class="comment">		    @Service @Repository @Autowired等</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		当前扫描操作不是spring ，是springmvc</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		多个bean元素 </span></span><br><span class="line"><span class="comment">		映射器(请求)、适配器（执行方法）、类型转换 （参数、json）</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		/请求    加载静态资源 js css &lt;img&gt; </span></span><br><span class="line"><span class="comment">		*.do请求不需要配置静态资源加载</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		location属性表示当前工程需要映射的路径</span></span><br><span class="line"><span class="comment">		mapping属性表示映射加载location属性指定的路径，</span></span><br><span class="line"><span class="comment">				加载静态资源文件 js css &lt;img&gt;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		*表示一层目录    /js/*    /js/js1/</span></span><br><span class="line"><span class="comment">		**表示多层目录 /js/**   /js/js1/js2/js3/js4/</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		视图解析器 </span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		上传解析器</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		getBean("multipartResolver")</span></span><br><span class="line"><span class="comment">		注意事项 id必须为  id="multipartResolver"</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 默认编码为ISO-8859-1 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> </span></span><br><span class="line"><span class="tag">					<span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 设置上传大小  单位b  3M-5M  3*1024*1204--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> </span></span><br><span class="line"><span class="tag">		            <span class="attr">value</span>=<span class="string">"3000000"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ajax.jsp    =&gt;前端页面发送ajax请求</li>
</ul>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; //请求发送json参数</span><br><span class="line">&gt; 		//响应接收json参数</span><br><span class="line">&gt; 		</span><br><span class="line">&gt; 		//js转换json</span><br><span class="line">&gt; 		//JSON.parse(str);   将json字符串转换成js对象</span><br><span class="line">&gt; 		//JSON.stringify(object); 将js对象转换成json字符串</span><br><span class="line">&gt; 		</span><br><span class="line">&gt; 		//java  JSONObject</span><br><span class="line">&gt; 		</span><br><span class="line">&gt; 		//js字面量 对象</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/js/jquery-1.11.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">	$(function()&#123;</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		//请求发送json参数</span></span><br><span class="line"><span class="undefined">		//响应接收json参数</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		//js转换json</span></span><br><span class="line"><span class="undefined">		//JSON.parse(str);   将json字符串转换成js对象</span></span><br><span class="line"><span class="undefined">		//JSON.stringify(object); 将js对象转换成json字符串</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		//java  JSONObject</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		//js字面量 对象</span></span><br><span class="line"><span class="undefined">		var obj = &#123;</span></span><br><span class="line"><span class="undefined">			  id : 'et',</span></span><br><span class="line"><span class="undefined">			  name : 'et1803',</span></span><br><span class="line"><span class="undefined">			  age : 5</span></span><br><span class="line"><span class="undefined">		&#125;;</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		$.ajax(&#123;</span></span><br><span class="line"><span class="undefined">			//后台访问请求地址</span></span><br><span class="line"><span class="undefined">			url : '$&#123;pageContext.request.contextPath &#125;/ajax',</span></span><br><span class="line"><span class="undefined">			//请求参数内容类型  415 406</span></span><br><span class="line"><span class="undefined">			contentType : "application/json",</span></span><br><span class="line"><span class="undefined">			//请求参数</span></span><br><span class="line"><span class="undefined">			data : JSON.stringify(obj),</span></span><br><span class="line"><span class="undefined">			//请求类型</span></span><br><span class="line"><span class="undefined">			type : 'post',</span></span><br><span class="line"><span class="undefined">			//响应参数格式</span></span><br><span class="line"><span class="undefined">			dataType : 'json',</span></span><br><span class="line"><span class="undefined">			//响应成功之后执行success方法</span></span><br><span class="line"><span class="undefined">			success : function(data) &#123;</span></span><br><span class="line"><span class="undefined">				console.log(data.success);</span></span><br><span class="line"><span class="undefined">			&#125;</span></span><br><span class="line"><span class="undefined">		&#125;);</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">	&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>​     AjaxContrller.java             controller 接收和处理请求          </li>
</ul>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="comment">/**</span></span><br><span class="line"><span class="comment">&gt; * </span></span><br><span class="line"><span class="comment">&gt; * springmvc 响应参数</span></span><br><span class="line"><span class="comment">&gt; * </span></span><br><span class="line"><span class="comment">&gt; *    跳转视图2种类型</span></span><br><span class="line"><span class="comment">&gt; *     String</span></span><br><span class="line"><span class="comment">&gt; *     ModelAndView</span></span><br><span class="line"><span class="comment">&gt; *     </span></span><br><span class="line"><span class="comment">&gt; *     void  HttpServletResponse 下载  </span></span><br><span class="line"><span class="comment">&gt; *     		 HttpServletRequest</span></span><br><span class="line"><span class="comment">&gt; *    </span></span><br><span class="line"><span class="comment">&gt; *     响应json类型  随意定义类型    String、ModelAndView除外 </span></span><br><span class="line"><span class="comment">&gt; *     &#123;key:value,key:value&#125;   Map put(key) User key</span></span><br><span class="line"><span class="comment">&gt; *     [ &#123;key:value,key:value&#125;, &#123;key:value,key:value&#125;] List&lt;Map&gt;</span></span><br><span class="line"><span class="comment">&gt; *     [value,value,value]  List&lt;String&gt; List&lt;Integer&gt;</span></span><br><span class="line"><span class="comment">&gt; *     </span></span><br><span class="line"><span class="comment">&gt; *     <span class="doctag">@RequestBody</span>接收请求json字符串，</span></span><br><span class="line"><span class="comment">&gt; *                 再将json字符串转换成java对象</span></span><br><span class="line"><span class="comment">&gt; *                 put("id","et")</span></span><br><span class="line"><span class="comment">&gt; *                 put("name","et1803");</span></span><br><span class="line"><span class="comment">&gt; *                 put("age",5);</span></span><br><span class="line"><span class="comment">&gt; *                 </span></span><br><span class="line"><span class="comment">&gt; *        request.getInputStream();</span></span><br><span class="line"><span class="comment">&gt; *     <span class="doctag">@ResponseBody</span></span></span><br><span class="line"><span class="comment">&gt; *                 将对象转换成json字符串</span></span><br><span class="line"><span class="comment">&gt; *        response.getOutputStream();</span></span><br><span class="line"><span class="comment">&gt; *        response.getWriter();</span></span><br><span class="line"><span class="comment">&gt; */</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * springmvc 响应参数</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 *    跳转视图2种类型</span></span><br><span class="line"><span class="comment">	 *     String</span></span><br><span class="line"><span class="comment">	 *     ModelAndView</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 *     void  HttpServletResponse 下载  </span></span><br><span class="line"><span class="comment">	 *     		 HttpServletRequest</span></span><br><span class="line"><span class="comment">	 *    </span></span><br><span class="line"><span class="comment">	 *     响应json类型  随意定义类型    String、ModelAndView除外 </span></span><br><span class="line"><span class="comment">	 *     &#123;key:value,key:value&#125;   Map put(key) User key</span></span><br><span class="line"><span class="comment">	 *     [ &#123;key:value,key:value&#125;, &#123;key:value,key:value&#125;] List&lt;Map&gt;</span></span><br><span class="line"><span class="comment">	 *     [value,value,value]  List&lt;String&gt; List&lt;Integer&gt;</span></span><br><span class="line"><span class="comment">	 *     </span></span><br><span class="line"><span class="comment">	 *     <span class="doctag">@RequestBody</span>接收请求json字符串，</span></span><br><span class="line"><span class="comment">	 *                 再将json字符串转换成java对象</span></span><br><span class="line"><span class="comment">	 *                 put("id","et")</span></span><br><span class="line"><span class="comment">	 *                 put("name","et1803");</span></span><br><span class="line"><span class="comment">	 *                 put("age",5);</span></span><br><span class="line"><span class="comment">	 *                 </span></span><br><span class="line"><span class="comment">	 *        request.getInputStream();</span></span><br><span class="line"><span class="comment">	 *     <span class="doctag">@ResponseBody</span></span></span><br><span class="line"><span class="comment">	 *                 将对象转换成json字符串</span></span><br><span class="line"><span class="comment">	 *        response.getOutputStream();</span></span><br><span class="line"><span class="comment">	 *        response.getWriter();</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/ajax"</span>)</span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">ajax</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@RequestBody Map&lt;String,Object&gt; map)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取参数信息</span></span><br><span class="line">		String id = (String)map.get(<span class="string">"id"</span>);</span><br><span class="line">		String name = map.get(<span class="string">"name"</span>).toString();</span><br><span class="line">		String age = map.get(<span class="string">"age"</span>).toString();</span><br><span class="line">		<span class="comment">//输出信息</span></span><br><span class="line">		System.out.println(<span class="string">"ID:"</span> + id);</span><br><span class="line">		System.out.println(<span class="string">"NAME:"</span> + name);</span><br><span class="line">		System.out.println(<span class="string">"AGE:"</span> + age);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//响应参数</span></span><br><span class="line">		Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		result.put(<span class="string">"success"</span>, <span class="string">"响应参数："</span> + id + <span class="string">","</span> + name);</span><br><span class="line">		<span class="comment">//&#123;success: "响应参数：" + id + "," + name&#125;</span></span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="代码示例二：-拦截器和自定义注解"><a href="#代码示例二：-拦截器和自定义注解" class="headerlink" title="代码示例二：   拦截器和自定义注解"></a>代码示例二：   拦截器和自定义注解</h6><ul>
<li>web.xml        =&gt; <!-- 自定义加载springmvc配置文件路径 --></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>springmvc01<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 请求 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 响应 默认编码 iso-8859-1 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 处理乱码 post请求 end --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- springmvc start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		默认加载springmvc配置文件路径为：</span></span><br><span class="line"><span class="comment">  				WEB-INF/[servlet-name]-serlvet.xml</span></span><br><span class="line"><span class="comment">  	 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 自定义加载springmvc配置文件路径 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:etoak-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>etoak<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		springmvc 只兼容2种请求格式</span></span><br><span class="line"><span class="comment">  		1. *.do   *.action</span></span><br><span class="line"><span class="comment">  			禁止使用 *.html   不兼容json格式</span></span><br><span class="line"><span class="comment">  		2. 斜杠(/) </span></span><br><span class="line"><span class="comment">  		        禁止使用/*</span></span><br><span class="line"><span class="comment">  		        使用/请求 表示springmvc集成restful</span></span><br><span class="line"><span class="comment">  		        使用/请求 默认不加载静态资源   js、css、&lt;img&gt;</span></span><br><span class="line"><span class="comment">  	--&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springmvc end --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>etoak-servlet.xml      =&gt; 加载静态资源，并配置拦截器</p>
<blockquote>
<!-- 
       配置拦截器 
       springmvc中拦截器 除了视图（jsp,html）不拦截 ,
                       剩下的请求都会被拦截
   -->
</blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		扫描ioc注解</span></span><br><span class="line"><span class="comment">			@Controller</span></span><br><span class="line"><span class="comment">		      spring 实例化</span></span><br><span class="line"><span class="comment">              springmvc 实例化 服务端</span></span><br><span class="line"><span class="comment">		    @Service @Repository @Autowired等</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		当前扫描操作不是spring ，是springmvc</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.etoak"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		多个bean元素 </span></span><br><span class="line"><span class="comment">		映射器(请求)、适配器（执行方法）、类型转换 （参数、json）</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		/请求    加载静态资源 js css &lt;img&gt; </span></span><br><span class="line"><span class="comment">		*.do请求不需要配置静态资源加载</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		location属性表示当前工程需要映射的路径</span></span><br><span class="line"><span class="comment">		mapping属性表示映射加载location属性指定的路径，</span></span><br><span class="line"><span class="comment">				加载静态资源文件 js css &lt;img&gt;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		*表示一层目录    /js/*    /js/js1/</span></span><br><span class="line"><span class="comment">		**表示多层目录 /js/**   /js/js1/js2/js3/js4/</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		配置拦截器 </span></span><br><span class="line"><span class="comment">		springmvc中拦截器 除了视图（jsp,html）不拦截 ,</span></span><br><span class="line"><span class="comment">						剩下的请求都会被拦截</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">		    <span class="comment">&lt;!-- 需要拦截的请求地址 --&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 	</span></span><br><span class="line"><span class="comment">			&lt;mvc:mapping path="/login/login" /&gt;</span></span><br><span class="line"><span class="comment">			&lt;mvc:mapping path="/login/logout" /&gt; </span></span><br><span class="line"><span class="comment">			&lt;mvc:mapping path="/login/*" /&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 不需要拦截的请求地址 --&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- &lt;mvc:exclude-mapping path="/login/logout" /&gt; --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">"/js/**"</span> /&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">				配置拦截器对象，并实例化该对象 </span></span><br><span class="line"><span class="comment">				拦截器需要实现HandlerInterceptor接口</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.etoak.common.AuthInterceptor"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- &lt;ref bean="authInterceptor" /&gt; --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		视图解析器 </span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		上传解析器</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		getBean("multipartResolver")</span></span><br><span class="line"><span class="comment">		注意事项 id必须为  id="multipartResolver"</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 默认编码为ISO-8859-1 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> </span></span><br><span class="line"><span class="tag">					<span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- 设置上传大小  单位b  3M-5M  3*1024*1204--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> </span></span><br><span class="line"><span class="tag">		            <span class="attr">value</span>=<span class="string">"3000000"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>前端页面   (发送请求)  login.jsp</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span> </span><br><span class="line">		src="$&#123;pageContext.request.contextPath &#125;/js/jquery-1.11.1.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">"$&#123;pageContext.request.contextPath &#125;/login/login"</span>&gt;</span><br><span class="line">	登录</span><br><span class="line">&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;br/&gt;</span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">"$&#123;pageContext.request.contextPath &#125;/login/logout"</span>&gt;</span><br><span class="line">	退出</span><br><span class="line">&lt;/a&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">------------   success.jsp</span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">success!!!</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">--------------  error.jsp</span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/html4/loose.dtd"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">当前操作没有权限！！！！</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>配置拦截器</strong>  (springmvc实现拦截器操作 需要实现HandlerInterceptor接口)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.HandlerMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  springmvc实现拦截器操作 需要实现HandlerInterceptor接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 3.在跳转响应视图成功之后，触发afterCompletion方法</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletRequest request, </span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletResponse response,</span></span></span><br><span class="line"><span class="function"><span class="params">			Object object, Exception ex)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"执行afterCompletion方法！！！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 2.在跳转响应视图之前，触发postHandle方法</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletRequest request, </span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletResponse response, </span></span></span><br><span class="line"><span class="function"><span class="params">			Object object, </span></span></span><br><span class="line"><span class="function"><span class="params">			ModelAndView mv)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"执行postHandle方法！！！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 1.在访问后台请求时 先触发preHandle方法</span></span><br><span class="line"><span class="comment">	 *   返回值返回true表示验证通过，可以执行后台请求方法</span></span><br><span class="line"><span class="comment">	 *   反之返回false验证不通过，不能执行后台请求方法</span></span><br><span class="line"><span class="comment">	 *   默认为false;</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletRequest request, </span></span></span><br><span class="line"><span class="function"><span class="params">			HttpServletResponse response, </span></span></span><br><span class="line"><span class="function"><span class="params">			Object object)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"执行拦截器操作！！！"</span>);</span><br><span class="line">		System.out.println(<span class="string">"url："</span> + request.getRequestURL());</span><br><span class="line">		System.out.println(<span class="string">"uri："</span> + request.getRequestURI());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取后台请求方法</span></span><br><span class="line">		HandlerMethod hm = (HandlerMethod)object;</span><br><span class="line">		<span class="comment">//当前method对象表示 后台请求的方法</span></span><br><span class="line">		Method method = hm.getMethod();</span><br><span class="line">		<span class="comment">//判断方法上是否存在@Etoak注解</span></span><br><span class="line">		Etoak etoak = method.getAnnotation(Etoak.class);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(etoak != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="comment">//获取@Etoak注解et属性</span></span><br><span class="line">			String et = etoak.et();</span><br><span class="line">			<span class="keyword">if</span>(et != <span class="keyword">null</span> &amp;&amp; <span class="string">"etoak"</span>.equals(et)) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		response.sendRedirect(request.getContextPath() + <span class="string">"/error.jsp"</span>);</span><br><span class="line">		<span class="comment">//默认为验证不通过</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> ——- 自定义注解，用来判断权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">//作用域  该注解只能使用在方法上</span></span><br><span class="line"><span class="meta">@Target</span>(&#123; java.lang.annotation.ElementType.METHOD&#125;)</span><br><span class="line"><span class="comment">//运行时执行该注解</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Etoak &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">et</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.etoak.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.etoak.common.Etoak;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/login"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Etoak</span>(et=<span class="string">"etoak"</span>)</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/login"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"登录操作！！！"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Etoak</span>(et=<span class="string">"et1803"</span>)</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/logout"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">logout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"退出操作"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</bean>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2018/08/29/spring/">Spring框架入门（1）</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Hide it away</a></p>
        <p><span>发布时间:</span>2018-08-29, 09:22:59</p>
        <p><span>最后更新:</span>2018-08-29, 12:44:43</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2018/08/29/spring/" title="Spring框架入门（1）">http://yoursite.com/2018/08/29/spring/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2018/08/29/spring/　　作者: Hide it away" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2018/08/29/hexo上传流程/">
                    Hexo简单实用（1）
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2018/08/22/h5/">
                    
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring框架总结"><span class="toc-number">1.</span> <span class="toc-text">Spring框架总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-0-spring简介"><span class="toc-number">2.</span> <span class="toc-text">1.0 spring简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Spring-IOC"><span class="toc-number">3.</span> <span class="toc-text">1.1 Spring   IOC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#spring-ioc-介绍"><span class="toc-number">3.1.</span> <span class="toc-text">spring ioc 介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注入方法："><span class="toc-number">3.2.</span> <span class="toc-text">注入方法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用示例"><span class="toc-number">3.3.</span> <span class="toc-text">使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#准备工作："><span class="toc-number">3.3.1.</span> <span class="toc-text">准备工作：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#程序思路"><span class="toc-number">3.3.2.</span> <span class="toc-text">程序思路</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#gt-无参构造："><span class="toc-number">3.3.2.1.</span> <span class="toc-text">>无参构造：  </span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#gt-无参构造流程"><span class="toc-number">3.3.2.1.1.</span> <span class="toc-text">> 无参构造流程</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#gt-有参构造"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">> 有参构造</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#gt-集合的依赖注入："><span class="toc-number">3.3.2.3.</span> <span class="toc-text">> 集合的依赖注入：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Spring-bean的-Scope"><span class="toc-number">4.</span> <span class="toc-text">1.2 Spring bean的 Scope</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#scope有4种类型："><span class="toc-number">4.1.</span> <span class="toc-text">scope有4种类型：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Spring的依赖。"><span class="toc-number">4.2.</span> <span class="toc-text">3.Spring的依赖。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Spring读取外部资源-–JDBC"><span class="toc-number">4.3.</span> <span class="toc-text">**4.Spring读取外部资源 –JDBC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-p命名空间的使用"><span class="toc-number">4.4.</span> <span class="toc-text">5.  p命名空间的使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-通过ioc创建对象"><span class="toc-number">5.</span> <span class="toc-text">1.3 通过ioc创建对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-IOC通过工厂方法创建对象"><span class="toc-number">5.0.1.</span> <span class="toc-text">1.IOC通过工厂方法创建对象</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#学习静态工厂方法。"><span class="toc-number">5.0.1.1.</span> <span class="toc-text">学习静态工厂方法。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-实例工厂方法"><span class="toc-number">5.0.1.2.</span> <span class="toc-text">2.实例工厂方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-IOC自动装载（autowire）"><span class="toc-number">5.0.2.</span> <span class="toc-text">2.IOC自动装载（autowire）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通过IOC容器架构程序的分层。"><span class="toc-number">5.0.3.</span> <span class="toc-text">通过IOC容器架构程序的分层。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基于注解的方式："><span class="toc-number">5.0.4.</span> <span class="toc-text">基于注解的方式：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码实例："><span class="toc-number">6.</span> <span class="toc-text">代码实例：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#spring-注入方法"><span class="toc-number">6.0.1.</span> <span class="toc-text">spring 注入方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-作用域"><span class="toc-number">6.0.2.</span> <span class="toc-text">Spring 作用域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码实例：-1"><span class="toc-number">6.0.3.</span> <span class="toc-text">代码实例：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#集合类型，引用类型的-注入"><span class="toc-number">6.0.4.</span> <span class="toc-text">集合类型，引用类型的 注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置文件配置-各种方法的设置"><span class="toc-number">6.0.5.</span> <span class="toc-text">配置文件配置  各种方法的设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-基本注解"><span class="toc-number">6.0.6.</span> <span class="toc-text">Spring  基本注解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#注解总结"><span class="toc-number">6.0.6.1.</span> <span class="toc-text">注解总结</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#controller"><span class="toc-number">6.0.6.1.1.</span> <span class="toc-text">controller</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Service"><span class="toc-number">6.0.6.1.2.</span> <span class="toc-text">Service</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Dao"><span class="toc-number">6.0.6.1.3.</span> <span class="toc-text">Dao</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Test"><span class="toc-number">6.0.6.1.4.</span> <span class="toc-text">Test</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-0-Spring-aop-简介"><span class="toc-number">7.</span> <span class="toc-text">2.0  Spring   aop 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#aop相关"><span class="toc-number">7.0.1.</span> <span class="toc-text">aop相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aop简介"><span class="toc-number">7.0.2.</span> <span class="toc-text">aop简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例1："><span class="toc-number">7.0.3.</span> <span class="toc-text">代码示例1：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例2："><span class="toc-number">7.0.4.</span> <span class="toc-text">代码示例2：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-0-Spring整合mybatis"><span class="toc-number">8.</span> <span class="toc-text">3.0 Spring整合mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#操作数据库相关知识"><span class="toc-number">8.0.1.</span> <span class="toc-text">操作数据库相关知识</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-0-Spring-mvc-总结"><span class="toc-number">9.</span> <span class="toc-text">4.0  Spring mvc 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SpringMvc简介"><span class="toc-number">9.0.1.</span> <span class="toc-text">SpringMvc简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SpringMVC实现原理："><span class="toc-number">9.0.2.</span> <span class="toc-text">SpringMVC实现原理：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#环境搭建"><span class="toc-number">9.0.2.1.</span> <span class="toc-text">环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#代码示例-1："><span class="toc-number">9.0.2.1.1.</span> <span class="toc-text">代码示例 1：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#代码示例2：-1"><span class="toc-number">9.0.2.1.2.</span> <span class="toc-text">代码示例2：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Springmvc-的request域和session域-amp-amp-乱码处理"><span class="toc-number">9.0.3.</span> <span class="toc-text">Springmvc 的request域和session域&&乱码处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#文件上传和下载"><span class="toc-number">9.0.4.</span> <span class="toc-text">文件上传和下载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#代码示例1：-1"><span class="toc-number">9.0.4.1.</span> <span class="toc-text">代码示例1：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#代码示例2：-2"><span class="toc-number">9.0.4.2.</span> <span class="toc-text">代码示例2：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ajax-amp-json"><span class="toc-number">9.0.5.</span> <span class="toc-text">ajax  & json</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#代码示例1"><span class="toc-number">9.0.5.0.1.</span> <span class="toc-text">代码示例1:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#代码示例二：-拦截器和自定义注解"><span class="toc-number">9.0.5.0.2.</span> <span class="toc-text">代码示例二：   拦截器和自定义注解</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-4 i,
        .toc-level-4 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"true"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Spring框架入门（1）　| 马克图布！　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://yoursite.com/2018/08/29/spring/';
            this.page.identifier = '2018/08/29/spring/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2018/08/29/hexo上传流程/" title="上一篇: Hexo简单实用（1）">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2018/08/22/h5/" title="下一篇: ">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/31/Git快速使用/">Git快速使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/31/Git和Github详解/">Git和GitHub详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/30/Oracle/">Oracle入门（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/29/hexo上传流程/">Hexo简单实用（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/29/spring/">Spring框架入门（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/22/h5/">h5</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/MySQL笔记/">MySQL极简</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/markdown语法/">markdown 语法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/JavaScript标记/">前端 简单笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/hexo和yelee主题使用/">hexo和yelee主题的使用笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/Hbuilder使用技巧/">Hbuilder使用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/10/hello-world/">Hello World</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2018 Hide it away
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 4;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
             tags: ".article-tag a", 
             categories: ".article-category a, a.tag-list-link", 
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>